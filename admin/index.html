<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <title>Admin Dashboard</title>
    <script data-cfasync="false" src="https://cdn.jsdelivr.net/npm/@keeex/qrcodejs-kx@1.0.2/qrcode.min.js"></script>
    <style>
        /* Base reset */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            overflow: hidden;
            background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 50%, #1a1a1a 100%);
        }

        /* Common animations */
        @keyframes blurOverlayAppear {
            0% {
                opacity: 0;
                -webkit-backdrop-filter: blur(0px);
                backdrop-filter: blur(0px);
            }
            100% {
                opacity: 1;
                -webkit-backdrop-filter: blur(12px);
                backdrop-filter: blur(12px);
            }
        }

        @keyframes containerAppear {
            0% {
                opacity: 0;
                transform: translateY(30px) scale(0.9);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }

        @keyframes gradientShift {
            0% { background-position: 0 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0 50%; }
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Background and overlay */
        #background-iframe {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 0;
            z-index: -3 !important;
        }

        #blur-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0, rgba(118, 75, 162, 0.15) 100%);
            -webkit-backdrop-filter: blur(12px);
            backdrop-filter: blur(12px);
            z-index: -2 !important;
            animation: blurOverlayAppear 1.5s ease-out forwards .3s;
            pointer-events: none;
            opacity: 0;
        }

        /* Common container wrapper */
        .page-wrapper {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1 !important;
            padding: 20px;
            overflow-y: auto;
        }

        /* Common card container */
        .card-container {
            background: rgba(255, 255, 255, 0.95);
            -webkit-backdrop-filter: blur(20px);
            backdrop-filter: blur(20px);
            padding: 50px 40px;
            border-radius: 24px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3), 0 0 0 1px rgba(255, 255, 255, 0.1) inset;
            width: 100%;
            max-width: 1200px;
            animation: containerAppear 1s ease-out .8s backwards;
            position: relative;
            overflow: hidden;
            margin: 20px auto;
        }

        .card-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #faab41 0, #f6821f 50%, #faab41 100%);
            background-size: 200% 100%;
            animation: gradientShift 3s ease infinite;
        }

        /* Page header and icon */
        .page-header {
            margin-bottom: 35px;
            text-align: center;
        }

        .page-icon {
            width: 70px;
            height: 70px;
            margin: 0 auto 20px;
            background: linear-gradient(135deg, #faab41 0, #f6821f 100%);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
            animation: fadeIn .8s ease-out 1s backwards;
        }

        .page-icon svg {
            width: 36px;
            height: 36px;
            fill: white;
        }

        .page-title {
            font-size: 32px;
            font-weight: 700;
            background: linear-gradient(135deg, #faab41 0, #f6821f 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 0 0 12px;
            line-height: 1.2;
            letter-spacing: -0.5px;
        }

        .page-subtitle {
            font-size: 16px;
            color: #6b7280;
            margin: 0;
            line-height: 1.5;
            font-weight: 400;
        }

        /* Form styles */
        .page-form {
            display: flex;
            flex-direction: column;
            margin-top: 35px;
        }

        .form-group {
            margin-bottom: 24px;
            text-align: left;
            position: relative;
        }

        .form-group label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #374151;
            letter-spacing: .3px;
        }

        .input-wrapper {
            position: relative;
        }

        .input-icon {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            height: 20px;
            opacity: .4;
            pointer-events: none;
            transition: opacity .3s ease;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 16px;
            border: 2px solid #e5e7eb !important;
            border-radius: 12px;
            font-size: 16px;
            color: #1f2937 !important;
            background-color: #fff !important;
            box-sizing: border-box;
            transition: all .3s ease;
            -webkit-appearance: none;
            appearance: none;
            font-family: inherit;
        }

        .form-group input.with-icon {
            padding-left: 48px;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: 0 !important;
            border-color: #faab41 !important;
            box-shadow: 0 0 0 4px rgba(250, 171, 65, 0.1) !important;
        }

        .form-group input:focus + .input-icon {
            opacity: .7;
        }

        .form-group input:disabled,
        .form-group select:disabled {
            background-color: #f3f4f6 !important;
            color: #9ca3af !important;
            cursor: not-allowed;
            opacity: 1;
        }

        .form-group input[readonly] {
            background-color: #f9fafb !important;
            color: #6b7280 !important;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 382px;
            font-family: 'Monaco', 'Courier New', monospace;
        }

        /* Button styles */
        .btn {
            padding: 10px 20px;
            border: 0;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all .3s ease;
            box-sizing: border-box;
            -webkit-appearance: none;
            appearance: none;
            letter-spacing: .5px;
            position: relative;
            overflow: hidden;
        }

        .btn-primary {
            background: linear-gradient(135deg, #faab41 0, #f6821f 100%);
            color: #fff;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left .5s ease;
        }

        .btn-primary:hover::before {
            left: 100%;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(102, 126, 234, 0.5);
        }

        .btn-primary:active {
            transform: translateY(0);
            box-shadow: 0 2px 10px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #e5e7eb;
            color: #374151;
        }

        .btn-secondary:hover {
            background: #d1d5db;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            pointer-events: none;
        }

        .btn-group {
            display: flex;
            gap: 10px;
        }

        /* Footer hint */
        .footer-hint {
            margin-top: 30px;
            font-size: 13px;
            color: #9ca3af;
            animation: fadeIn 1s ease-out 1.5s backwards;
            text-align: center;
        }

        .footer-hint a {
            color: #faab41;
            text-decoration: none;
            font-weight: 500;
            transition: color .3s ease;
        }

        .footer-hint a:hover {
            color: #f6821f;
        }

        /* Toast notification */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 12px 20px;
            border-radius: 8px;
            color: #fff;
            font-size: 14px;
            font-weight: 500;
            z-index: 10000000;
            transform: translateX(100%);
            transition: transform 0.3s ease, opacity 0.3s ease;
            opacity: 0;
            max-width: 300px;
            word-wrap: break-word;
        }

        .toast.show {
            transform: translateX(0);
            opacity: 1;
        }

        .toast-success {
            background: linear-gradient(135deg, #10b981 0, #059669 100%);
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
        }

        .toast-error {
            background: linear-gradient(135deg, #ef4444 0, #dc2626 100%);
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3);
        }

        .toast-info {
            background: linear-gradient(135deg, #3b82f6 0, #1d4ed8 100%);
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
        }

        /* Message prompts */
        .message {
            margin-top: 24px;
            font-size: 14px;
            line-height: 1.5;
            padding: 14px 18px;
            border-radius: 12px;
            font-weight: 500;
            animation: slideIn .3s ease-out;
        }

        .message-success {
            background: linear-gradient(135deg, #10b981 0, #059669 100%);
            color: #fff;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
        }

        .message-error {
            background: linear-gradient(135deg, #ef4444 0, #dc2626 100%);
            color: #fff;
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3);
            animation: shake .5s ease-in-out, slideIn .3s ease-out;
        }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000000000;
            justify-content: center;
            align-items: center;
        }

        .modal-overlay.show {
            display: flex;
        }

        .modal {
            background: #fff;
            border-radius: 16px;
            padding: 30px;
            max-width: 500px;
            width: 95%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            text-align: center;
            z-index: 2000000001;
            position: relative;
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #9ca3af;
        }

        .modal-close:hover {
            color: #1f2937;
        }

        /* Social links */
        .social-links {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
            padding: 10px 0;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .social-text {
            font-size: 14px;
            color: #666;
            margin-right: 10px;
        }

        .social-link {
            display: inline-block;
            background: none;
            border: none;
            color: #666;
            text-decoration: none;
            cursor: pointer;
            transition: color 0.3s ease;
            border-radius: 8px;
            padding: 6px;
            border: 1px solid transparent;
        }

        .social-link:hover {
            color: #faab41;
            border-color: #faab41;
            transform: translateY(-2px);
        }

        .social-link svg {
            width: 20px;
            height: 20px;
        }

        /* Checkbox styles */
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .checkbox-group input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
            padding: 0;
            border: 2px solid #e5e7eb;
            border-radius: 4px;
            -webkit-appearance: none;
            appearance: none;
            position: relative;
            transition: all 0.3s ease;
            background-color: #fff;
        }

        .checkbox-group input[type="checkbox"]:hover {
            border-color: #faab41;
        }

        .checkbox-group input[type="checkbox"]:checked {
            background: linear-gradient(135deg, #faab41 0, #f6821f 100%);
            border-color: #faab41;
        }

        .checkbox-group input[type="checkbox"]:checked::after {
            content: '';
            position: absolute;
            left: 5px;
            top: 2px;
            width: 4px;
            height: 8px;
            border: solid white;
            border-width: 0 2px 2px 0;
            transform: rotate(45deg);
        }

        .checkbox-group input[type="checkbox"]:disabled {
            background-color: #f3f4f6;
            border-color: #d1d5db;
            cursor: not-allowed;
            opacity: 0.6;
        }

        .checkbox-group input[type="checkbox"]:disabled:hover {
            border-color: #d1d5db;
        }

        .checkbox-label {
            font-size: 14px;
            color: #374151;
            cursor: pointer;
            -webkit-user-select: none;
            user-select: none;
        }

        /* Responsive design - Tablet */
        @media (max-width: 768px) {
            .page-wrapper {
                padding: 20px 16px;
                padding-top: 20px;
                padding-bottom: 20px;
                justify-content: flex-start;
                align-items: center;
            }

            .card-container {
                padding: 40px 28px;
                border-radius: 20px;
                max-width: 100%;
                margin-top: auto;
                margin-bottom: auto;
            }

            .page-icon {
                width: 60px;
                height: 60px;
                border-radius: 16px;
                margin-bottom: 16px;
            }

            .page-icon svg {
                width: 30px;
                height: 30px;
            }

            .page-title {
                font-size: 26px;
                margin-bottom: 10px;
            }

            .page-subtitle {
                font-size: 15px;
            }

            .page-form {
                margin-top: 28px;
            }

            .form-group {
                margin-bottom: 20px;
            }

            .form-group label {
                font-size: 13px;
                margin-bottom: 8px;
            }

            .form-group input,
            .form-group select,
            .form-group textarea {
                padding: 14px;
                font-size: 16px;
                border-radius: 10px;
            }

            .form-group input.with-icon {
                padding-left: 44px;
            }

            .input-icon {
                left: 14px;
                width: 18px;
                height: 18px;
            }

            .btn {
                padding: 15px 20px;
                font-size: 15px;
                border-radius: 10px;
            }

            .message {
                margin-top: 20px;
                font-size: 13px;
                padding: 12px 16px;
                border-radius: 10px;
            }

            .footer-hint {
                margin-top: 24px;
                font-size: 12px;
            }
        }

        /* Responsive design - Mobile */
        @media (max-width: 480px) {
            .page-wrapper {
                padding: 12px;
                justify-content: flex-start;
                align-items: center;
            }

            .card-container {
                padding: 35px 24px;
                border-radius: 18px;
                margin-top: auto;
                margin-bottom: auto;
            }

            .page-icon {
                width: 55px;
                height: 55px;
                border-radius: 14px;
            }

            .page-icon svg {
                width: 28px;
                height: 28px;
            }

            .page-title {
                font-size: 24px;
            }

            .page-subtitle {
                font-size: 14px;
            }
        }

        /* Responsive design - Landscape */
        @media (max-height: 600px) and (orientation: landscape) {
            .page-wrapper {
                padding: 20px;
                justify-content: flex-start;
                align-items: center;
            }

            .card-container {
                padding: 30px 35px;
                margin-top: auto;
                margin-bottom: auto;
            }

            .page-icon {
                width: 50px;
                height: 50px;
                margin-bottom: 12px;
            }

            .page-icon svg {
                width: 26px;
                height: 26px;
            }

            .page-title {
                font-size: 22px;
                margin-bottom: 8px;
            }

            .page-subtitle {
                font-size: 13px;
            }

            .page-form {
                margin-top: 20px;
            }

            .form-group {
                margin-bottom: 16px;
            }

            .footer-hint {
                margin-top: 16px;
            }
        }

        /* Dark mode */
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: rgba(255, 255, 255, 0.95);
            --text-primary: #1f2937;
            --text-secondary: #666;
            --border-color: #e5e7eb;
            --border-light: rgba(255, 255, 255, 0.1);
            --input-bg: #f3f4f6;
            --input-border: #e5e7eb;
            --overlay-bg: rgba(255, 255, 255, 0.7);
            --blur-overlay: rgba(0, 0, 0, 0.3);
        }

        html.dark-mode {
            --bg-primary: #1a1a1a;
            --bg-secondary: #0f0d0a;
            --text-primary: #e5e5e5;
            --text-secondary: #a0a0a0;
            --border-color: #333333;
            --border-light: rgba(255, 255, 255, 0.1);
            --input-bg: #2a2a2a;
            --input-border: #444444;
            --overlay-bg: rgba(32, 32, 32, 0.7);
            --blur-overlay: rgba(0, 0, 0, 0.5);
        }

        html.dark-mode body {
            background: linear-gradient(135deg, #1a1a1a 0, #2a2a2a 50%, #1a1a1a 100%) !important;
            color: var(--text-primary);
        }

        html.dark-mode #blur-overlay {
            background: var(--blur-overlay);
        }

        html.dark-mode .card-container {
            color: var(--text-primary);
        }

        html.dark-mode .page-wrapper {
            background: transparent;
        }

        html.dark-mode .header {
            background: rgba(39, 39, 39, 0.95);
            border-image: linear-gradient(90deg, #7c3aed 0, #5b21b6 50%, #7c3aed 100%) 1;
        }

        html.dark-mode .module {
            background: rgba(39, 39, 39, 0.95);
            color: var(--text-primary);
        }

        html.dark-mode .module-title {
            color: var(--text-primary);
        }

        html.dark-mode .form-group input:not([type="checkbox"]),
        html.dark-mode .form-group select,
        html.dark-mode .form-group textarea {
            background: var(--input-bg) !important;
            color: var(--text-primary) !important;
            border-color: var(--input-border) !important;
        }

        html.dark-mode .form-group input:not([type="checkbox"])::placeholder,
        html.dark-mode .form-group textarea::placeholder {
            color: var(--text-secondary) !important;
        }

        html.dark-mode .form-group input:not([type="checkbox"]):focus,
        html.dark-mode .form-group select:focus,
        html.dark-mode .form-group textarea:focus {
            border-color: #7c3aed !important;
            box-shadow: 0 0 0 4px rgba(124, 58, 237, 0.1) !important;
        }

        html.dark-mode .form-group input:not([type="checkbox"]):disabled,
        html.dark-mode .form-group select:disabled {
            background-color: var(--input-bg) !important;
            color: var(--text-secondary) !important;
        }

        html.dark-mode .form-group input:not([type="checkbox"])[readonly] {
            background-color: var(--input-bg) !important;
            color: var(--text-secondary) !important;
        }

        html.dark-mode .module .form-group input,
        html.dark-mode .module .form-group select,
        html.dark-mode .module .form-group textarea {
            background: var(--input-bg);
            color: var(--text-primary);
            border-color: var(--input-border);
        }

        html.dark-mode .module .form-group input::placeholder,
        html.dark-mode .module .form-group textarea::placeholder {
            color: var(--text-secondary);
        }

        html.dark-mode .modal-overlay {
            background: var(--blur-overlay);
        }

        html.dark-mode .modal {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border-color: var(--border-color);
        }

        html.dark-mode .modal input,
        html.dark-mode .modal select,
        html.dark-mode .modal textarea {
            background: var(--input-bg);
            color: var(--text-primary);
            border-color: var(--input-border);
        }

        html.dark-mode .form-group label {
            color: var(--text-primary) !important;
        }

        html.dark-mode .card-container {
            color: var(--text-primary);
        }

        html.dark-mode .modal-close {
            color: var(--text-primary);
        }

        html.dark-mode .page-header {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border-image: linear-gradient(90deg, #7c3aed 0, #5b21b6 50%, #7c3aed 100%) 1 !important;
        }

        html.dark-mode .page-title {
            color: var(--text-primary) !important;
        }

        html.dark-mode .page-subtitle {
            color: var(--text-secondary) !important;
        }

        html.dark-mode table {
            color: var(--text-primary);
        }

        html.dark-mode thead {
            background: #2a2a2a !important;
        }

        html.dark-mode thead th {
            background: #2a2a2a !important;
            color: var(--text-primary) !important;
            border-color: #333333 !important;
        }

        html.dark-mode tbody tr {
            border-color: #333333;
        }

        html.dark-mode tbody td {
            color: var(--text-primary);
        }

        html.dark-mode .social-link {
            color: var(--text-secondary);
        }

        html.dark-mode .social-link:hover {
            color: #7c3aed;
            border-color: #7c3aed;
        }

        html.dark-mode .social-links {
            border-color: rgba(255, 255, 255, 0.1);
        }

        html.dark-mode .btn-secondary {
            background: var(--input-bg) !important;
            color: var(--text-primary) !important;
            border-color: var(--input-border) !important;
        }

        html.dark-mode .btn-qrcode {
            background: linear-gradient(135deg, #0891b2 0, #065f73 100%) !important;
            color: #fff !important;
            box-shadow: 0 4px 15px rgba(8, 145, 178, 0.3) !important;
        }

        html.dark-mode .checkbox-group input[type="checkbox"] {
            border-color: var(--border-color);
            background: var(--input-bg);
        }

        html.dark-mode .checkbox-group input[type="checkbox"]:checked {
            background: linear-gradient(135deg, #7c3aed 0, #5b21b6 100%);
            border-color: #7c3aed;
        }

        html.dark-mode .loading {
            border-color: rgba(124, 58, 237, 0.3);
            border-top-color: #7c3aed;
        }

        html.dark-mode .message {
            animation: slideIn .3s ease-out;
        }

        html.dark-mode .success-message {
            background: linear-gradient(135deg, #059669 0, #047857 100%);
        }

        html.dark-mode .error-message {
            background: linear-gradient(135deg, #dc2626 0, #b91c1c 100%);
        }

        html.dark-mode .collapse-btn {
            color: #7c3aed;
        }

        html.dark-mode .collapse-btn:hover {
            color: #9f7aea;
        }

        html.dark-mode .collapse-section {
            border-left-color: #7c3aed;
            color: var(--text-primary);
        }

        html.dark-mode .module-footer {
            border-color: rgba(255, 255, 255, 0.1);
        }

        html.dark-mode .readonly-wrapper input[readonly] {
            background-color: var(--input-bg) !important;
            border-color: var(--input-border) !important;
            color: var(--text-primary) !important;
        }

        html.dark-mode .readonly-wrapper input[readonly]:hover {
            border-color: #7c3aed;
            background-color: var(--input-bg);
        }

        html.dark-mode .subapi-input {
            background-color: var(--input-bg) !important;
            color: var(--text-primary) !important;
        }

        html.dark-mode .input-icon {
            opacity: 0.6;
        }

        html.dark-mode .module-title {
            color: var(--text-primary) !important;
        }

        html.dark-mode .module-title .collapse-icon {
            fill: var(--text-secondary);
        }

        html.dark-mode .footer-hint {
            color: var(--text-secondary) !important;
        }

        html.dark-mode .footer-hint a {
            color: #7c3aed !important;
        }

        html.dark-mode .footer-hint a:hover {
            color: #9f7aea !important;
        }

        .theme-icon {
            transition: transform 0.3s ease;
        }

        .social-link.theme-toggle:hover .theme-icon {
            transform: rotate(20deg);
        }

        .social-link.theme-toggle {
            font-size: 0;
            line-height: 0;
        }

        .theme-icon {
            width: 20px;
            height: 20px;
            display: block !important;
            transition: all 0.3s ease;
        }

        .sun-icon {
            display: none !important;
            opacity: 0;
        }

        .moon-icon {
            display: block !important;
            opacity: 1;
        }

        html.dark-mode .sun-icon {
            display: block !important;
            opacity: 1;
        }

        html.dark-mode .moon-icon {
            display: none !important;
            opacity: 0;
        }

        .page-wrapper {
            justify-content: flex-start;
            align-items: flex-start;
        }

        .card-container {
            max-width: 1200px;
            margin: 20px auto;
            padding: 0;
            background: transparent !important;
            box-shadow: none !important;
        }

        .card-container::before {
            display: none;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.95);
            -webkit-backdrop-filter: blur(20px);
            backdrop-filter: blur(20px);
            padding: 25px 30px;
            border-radius: 16px;
            border-top: 4px solid;
            border-image: linear-gradient(90deg, #faab41 0, #f6821f 50%, #faab41 100%) 1;
        }

        .header-title h1 {
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(135deg, #faab41 0, #f6821f 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 0;
        }

        .header-buttons {
            display: flex;
            gap: 12px;
        }

        .header .btn {
            padding: 10px 20px;
            font-size: 14px;
            border-radius: 8px;
        }

        .module {
            background: rgba(255, 255, 255, 0.95);
            -webkit-backdrop-filter: blur(20px);
            backdrop-filter: blur(20px);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: 4px 4px 8px -3px rgba(0, 0, 0, 0.12);
            transition: box-shadow 280ms cubic-bezier(.2, .9, .2, 1), transform 220ms ease;
            will-change: transform;
        }

        .module:hover,
        .module:focus-within {
            box-shadow: 0 8px 16px -2px rgba(0, 0, 0, 0.14), 0 0 12px rgba(250, 171, 65, 0.08);
            transform: translateY(-4px);
        }

        .module-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 20px;
            color: #1f2937;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            gap: 10px;
        }

        .module-title .collapse-icon {
            width: 24px;
            height: 24px;
            transition: transform 0.28s;
            fill: #666;
            flex-shrink: 0;
        }

        .module.collapsed .collapse-icon {
            transform: rotate(90deg);
        }

        .module-content {
            display: block;
            overflow: hidden;
            max-height: 2000px;
            opacity: 1;
            transition: max-height 320ms cubic-bezier(.2, .8, .2, 1), opacity 220ms ease;
        }

        .module.collapsed .module-content {
            max-height: 0;
            opacity: 0;
        }

        .module .form-group {
            margin-bottom: 20px;
            display: grid;
            grid-template-columns: 200px 1fr;
            gap: 20px;
            align-items: center;
            text-align: left;
        }

        .module .form-group label {
            display: block;
        }

        .module .form-group input,
        .module .form-group select,
        .module .form-group textarea {
            padding: 8px 8px;
            border-radius: 8px;
        }

        .module .input-wrapper {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .module .input-wrapper input {
            flex: 1;
        }

        .readonly-wrapper {
            position: relative;
        }

        .readonly-wrapper input[readonly] {
            cursor: pointer;
            background-color: #fff !important;
            border: 2px solid #e5e7eb !important;
            color: #1f2937 !important;
        }

        .readonly-wrapper input[readonly]:hover {
            border-color: #faab41;
            background-color: #fff;
        }

        .readonly-wrapper input[readonly]:focus {
            outline: 0 !important;
            border-color: #faab41 !important;
            box-shadow: 0 0 0 4px rgba(250, 171, 65, 0.1) !important;
        }

        .copy-btn {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            padding: 6px 12px;
            font-size: 12px;
            cursor: pointer;
        }

        .module-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 10px;
            margin-top: 25px;
            padding-top: 20px;
            border-top: 1px solid #e5e7eb;
        }

        .module-footer .btn-group {
            margin-left: auto;
        }

        .collapse-section {
            margin-top: 15px;
            border-left: 3px solid #faab41;
            padding-left: 20px;
        }

        .collapse-btn {
            background: none;
            border: none;
            color: #faab41;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            padding: 0;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .collapse-btn:hover {
            color: #f6821f;
        }

        .success-message,
        .error-message {
            display: none;
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 14px;
            font-weight: 500;
            animation: slideIn 0.3s ease;
        }

        .success-message {
            background: linear-gradient(135deg, #10b981 0, #059669 100%);
            color: #fff;
        }

        .error-message {
            background: linear-gradient(135deg, #ef4444 0, #dc2626 100%);
            color: #fff;
        }

        .loading {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid #faab41;
            border-top-color: transparent;
            border-radius: 50%;
            animation: rotate 0.6s linear infinite;
        }

        @media (max-width: 768px) {
            .optimize-params-row {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .card-container {
                padding: 20px;
                margin: 0;
            }

            .header {
                flex-direction: column;
                gap: 15px;
                padding: 20px;
                margin-bottom: 20px;
            }

            .module {
                padding: 20px;
                margin-bottom: 20px;
            }

            .module .form-group {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .header-buttons {
                width: 100%;
                gap: 10px;
            }

            .header-buttons .btn {
                flex: 1;
            }
        }

        @media (max-width: 480px) {
            .card-container {
                padding: 15px;
            }
        }

        @media (max-height: 600px) and (orientation: landscape) {
            .card-container {
                padding: 15px;
            }
        }

        /* Custom button styles */
        .btn-reset {
            background: linear-gradient(135deg, #ef4444 0, #dc2626 100%);
            color: #fff;
        }

        .btn-all-logs {
            background: linear-gradient(135deg, #3b82f6 0, #1d4ed8 100%);
            flex-shrink: 0;
        }

        .btn-online-optimize {
            background: linear-gradient(135deg, #10b981 0, #059669 100%);
            color: #fff;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.4);
        }

        .btn-online-optimize:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(16, 185, 129, 0.5);
        }

        .btn-online-optimize:active {
            transform: translateY(0);
            box-shadow: 0 2px 10px rgba(16, 185, 129, 0.4);
        }

        .btn-close-modal {
            width: 100%;
            margin-top: 20px;
        }

        .btn-confirm-reset {
            background: linear-gradient(135deg, #ef4444 0, #dc2626 100%);
            color: #fff;
        }

        .btn-test-api {
            flex: 2;
            background: linear-gradient(135deg, #3b82f6 0, #1d4ed8 100%);
            color: #fff;
        }

        .btn-confirm-api {
            flex: 1;
            opacity: 0.5;
        }

        .btn-confirm-api:not([disabled]) {
            opacity: 1;
        }

        .btn-cancel-api {
            flex: 1;
        }

        .btn-qrcode {
            background: linear-gradient(135deg, #06b6d4 0, #0891b2 100%);
            color: #fff;
            box-shadow: 0 4px 15px rgba(6, 182, 212, 0.4);
        }

        .btn-qrcode:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(6, 182, 212, 0.5);
        }

        .btn-qrcode:active {
            transform: translateY(0);
            box-shadow: 0 2px 10px rgba(6, 182, 212, 0.4);
        }

        .btn-api-optimize {
            background: linear-gradient(135deg, #3b82f6 0, #1d4ed8 100%);
            color: #fff;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
        }

        .btn-api-optimize:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(59, 130, 246, 0.5);
        }

        .btn-api-optimize:active {
            transform: translateY(0);
            box-shadow: 0 2px 10px rgba(59, 130, 246, 0.4);
        }

        /* API optimization modal styles */
        .api-optimize-modal {
            overflow-y: auto;
            width: 90vw;
            max-width: 600px;
            margin: 0 auto;
            max-height: 90vh;
        }

        .api-optimize-modal-title {
            margin-bottom: 20px;
        }

        .api-form-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
        }

        .api-form-row {
            display: grid;
            grid-template-columns: 80px 1fr;
            gap: 10px;
            align-items: center;
        }

        .api-form-row label {
            font-size: 14px;
            font-weight: 600;
            color: #374151;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .api-form-row input {
            padding: 8px 12px;
            border-radius: 8px;
            border: 2px solid #e5e7eb;
            font-size: 14px;
        }

        .api-results-container {
            margin: 20px 0;
        }

        .api-results-label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 8px;
            text-align: left;
        }

        .api-results-textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 12px;
            height: 200px;
            background-color: #f9fafb;
            color: #1f2937;
            resize: vertical;
            overflow-y: auto;
        }

        .api-buttons {
            display: flex;
            gap: 10px;
            justify-content: space-between;
            margin-top: 20px;
        }

        .btn-verify-api {
            background: linear-gradient(135deg, #10b981 0, #059669 100%);
            color: #fff;
            flex: 1;
        }

        .btn-verify-api:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(16, 185, 129, 0.5);
        }

        .btn-append-api {
            background: linear-gradient(135deg, #f59e0b 0, #d97706 100%);
            color: #fff;
            opacity: 0.5;
            pointer-events: none;
        }

        .btn-append-api:not([disabled]) {
            opacity: 1;
            pointer-events: all;
        }

        .btn-append-api:hover:not([disabled]) {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(245, 158, 11, 0.5);
        }

        .btn-append-results {
            background: linear-gradient(135deg, #3b82f6 0, #1d4ed8 100%);
            color: #fff;
            opacity: 0.5;
            pointer-events: none;
        }

        .btn-append-results:not([disabled]) {
            opacity: 1;
            pointer-events: all;
        }

        .btn-append-results:hover:not([disabled]) {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(59, 130, 246, 0.5);
        }

        .btn-close-api {
            background: linear-gradient(135deg, #e5e7eb 0, #d1d5db 100%);
            color: #374151;
        }

        .btn-close-api:hover {
            background: linear-gradient(135deg, #d1d5db 0, #b3b8be 100%);
        }

        .btn-proxyip-help {
            background: linear-gradient(135deg, #10b981 0, #059669 100%);
            color: #fff !important;
            padding: 10px 16px;
            font-size: 14px;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
            transition: all 0.3s ease;
        }

        .btn-proxyip-help:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(16, 185, 129, 0.5);
        }

        .btn-proxyip-help:active {
            transform: translateY(0);
            box-shadow: 0 2px 10px rgba(16, 185, 129, 0.4);
        }

        .proxyip-help-modal {
            max-width: 1200px;
            width: 90vw;
            max-height: 100vh;
            overflow-y: auto;
        }

        .api-docs {
            text-align: left;
        }

        .api-docs h2 {
            font-size: 20px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 20px;
            margin-top: 0;
        }

        .api-docs h3 {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin: 20px 0 12px;
        }

        .api-docs p {
            font-size: 14px;
            line-height: 1.8;
            color: var(--text-secondary);
            margin-bottom: 12px;
        }

        .api-docs a {
            color: var(--primary-color);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .api-docs a:hover {
            text-decoration: underline;
        }

        .code-block {
            background: #fff3cd;
            color: #856404;
            border-left: 4px solid #ffc107;
            padding: 12px;
            border-radius: 4px;
            margin: 12px 0;
            font-size: 13px;
            line-height: 1.6;
            font-family: 'Monaco', 'Courier New', monospace;
            overflow-x: auto;
        }

        .simple-explanation {
            background: #e8f5e9;
            color: #2e7d32;
            border-left: 4px solid #4caf50;
            padding: 16px;
            border-radius: 4px;
            margin: 16px 0;
            font-size: 14px;
            line-height: 1.8;
        }

        .toggle-switch {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
        }

        .toggle-switch input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .toggle-switch label {
            cursor: pointer;
            margin: 0;
            font-weight: 600;
            -webkit-user-select: none;
            user-select: none;
        }

        html.dark-mode .code-block {
            background: #2a2a2a;
            color: #ffd699;
            border-left-color: #ffc107;
        }

        html.dark-mode .simple-explanation {
            background: #1b4620;
            color: #81c784;
            border-left-color: #4caf50;
        }

        html.dark-mode .btn-proxyip-help {
            background: linear-gradient(135deg, #10b981 0, #059669 100%);
            color: #fff !important;
        }

        html.dark-mode .btn-proxyip-help:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(16, 185, 129, 0.5);
        }

        html.dark-mode .api-optimize-modal {
            background: var(--bg-secondary);
            color: var(--text-primary);
        }

        html.dark-mode .api-form-row label {
            color: var(--text-primary);
        }

        html.dark-mode .api-form-row input {
            background: var(--input-bg);
            color: var(--text-primary);
            border-color: var(--input-border);
        }

        html.dark-mode .api-results-label {
            color: var(--text-primary);
        }

        html.dark-mode .api-results-textarea {
            background: var(--input-bg);
            color: var(--text-primary);
            border-color: var(--input-border);
        }

        html.dark-mode .btn-api-optimize {
            background: linear-gradient(135deg, #3b82f6 0, #1d4ed8 100%);
            color: #fff;
        }

        html.dark-mode .btn-verify-api {
            background: linear-gradient(135deg, #10b981 0, #059669 100%);
            color: #fff;
        }

        html.dark-mode .btn-append-api {
            background: linear-gradient(135deg, #f59e0b 0, #d97706 100%);
            color: #fff;
        }

        html.dark-mode .btn-append-results {
            background: linear-gradient(135deg, #3b82f6 0, #1d4ed8 100%);
            color: #fff;
        }

        html.dark-mode .btn-close-api {
            background: var(--input-bg);
            color: var(--text-primary);
        }

        html.dark-mode .btn-close-api:hover {
            background: var(--border-color);
        }

        /* Hidden elements */
        .hidden-section {
            display: none;
        }

        /* Cloudflare configuration section styles */
        #cloudflareEmailSection,
        #cloudflareAccountIDSection {
            display: none;
        }

        /* QRCode container */
        .qrcode-container {
            margin: 30px 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 350px;
            background: #FFFFFF;
        }

        /* Reset configuration popup */
        .reset-modal-title {
            color: #ef4444;
            margin-bottom: 15px;
        }

        .reset-modal-description {
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .reset-modal-confirm {
            color: #ef4444;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .reset-modal-buttons {
            display: flex;
            gap: 10px;
            justify-content: space-between;
        }

        /* Logs container */
        .logs-container {
            margin-bottom: 20px;
        }

        .logs-loading {
            text-align: center;
            padding: 20px;
            color: #6b7280;
        }

        .logs-footer {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            gap: 15px;
            margin-top: 20px;
        }

        .logs-footer-text {
            font-size: 12px;
            color: #9ca3af;
            margin: 0;
        }

        /* Logs modal */
        .logs-modal {
            overflow-y: auto;
            width: 90vw;
            max-width: 1400px;
            margin: 0 auto;
        }

        .logs-modal-title {
            margin-bottom: 20px;
        }

        .logs-all-container {
            max-height: 70vh;
            overflow-y: auto;
            overflow-x: auto;
        }

        /* Subscription API popup */
        .subapi-modal-title {
            margin-bottom: 20px;
        }

        .subapi-form-group {
            grid-template-columns: 1fr;
        }

        .subapi-status {
            margin: 15px 0;
            padding: 12px 16px;
            border-radius: 8px;
            display: none;
        }

        .subapi-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        /* Input field special styles */
        .subapi-input {
            cursor: pointer !important;
            background-color: #fff !important;
            color: #1f2937 !important;
        }

        /* Node link input wrapper */
        .link-input-wrapper {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .link-input-field {
            flex: 1;
        }

        /* Online optimization modal styles */
        .optimize-modal {
            overflow-y: auto;
            width: 90vw;
            max-width: 960px;
            margin: 0 auto;
            max-height: 90vh;
        }

        .optimize-modal-title {
            margin-bottom: 20px;
        }

        .ip-detection-box {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.05) 0%, rgba(6, 182, 212, 0.05) 100%);
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 8px;
            padding: 14px;
            margin-bottom: 20px;
        }

        .optimize-params-row {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
            align-items: flex-end;
        }

        .optimize-concurrency-input {
            width: 100%;
            max-width: none;
        }

        @media (max-width: 768px) {
            .optimize-params-row {
                grid-template-columns: 1fr;
            }
        }

        .ip-detection-info {
            font-size: 14px;
            color: #374151;
            line-height: 1.6;
        }

        .ip-detection-warning {
            color: #ef4444;
            font-size: 12px;
            margin-top: 8px;
            line-height: 1.5;
        }

        .optimize-progress-bar {
            width: 100%;
            height: 30px;
            background: #4b5563;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
            margin: 20px 0;
        }

        .optimize-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981 0%, #059669 100%);
            transition: width 0.3s ease, background 0.3s ease;
            position: absolute;
            top: 0;
            left: 0;
            border-radius: 15px;
        }

        .optimize-progress-text {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 13px;
            font-weight: 700;
            z-index: 1;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
        }

        .optimize-results-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .optimize-tab {
            padding: 8px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .optimize-tab:hover {
            border-color: #10b981;
        }

        .optimize-tab.active {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border-color: #10b981;
        }

        .optimize-results-content {
            background: #f9fafb;
            border-radius: 8px;
            padding: 15px;
            min-height: 200px;
            max-height: 400px;
            overflow-y: auto;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.1;
            text-align: left;
        }

        .optimize-result-item {
            padding: 1px 0;
            color: #1f2937;
            text-align: left;
        }

        .optimize-buttons {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 8px;
        }

        .btn-start-optimize {
            background: linear-gradient(135deg, #10b981 0, #059669 100%);
            color: #fff;
        }

        .btn-save-override,
        .btn-save-append {
            opacity: 0.5;
            pointer-events: none;
        }

        .btn-save-override:not([disabled]),
        .btn-save-append:not([disabled]) {
            opacity: 1;
            pointer-events: all;
        }

        .save-tip {
            font-size: 12px;
            color: #7a7f88;
            font-weight: normal;
            display: flex;
            align-items: center;
            min-height: 32px;
            margin-right: auto;
        }

        .btn-save-override {
            background: linear-gradient(135deg, #f59e0b 0, #d97706 100%);
            color: #fff;
        }

        .btn-save-append {
            background: linear-gradient(135deg, #3b82f6 0, #1d4ed8 100%);
            color: #fff;
        }

        html.dark-mode .ip-detection-box {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(6, 182, 212, 0.1) 100%);
            border-color: rgba(59, 130, 246, 0.3);
        }

        html.dark-mode .ip-detection-info {
            color: var(--text-primary);
        }

        html.dark-mode .optimize-progress-bar {
            background: #1f2937;
        }

        html.dark-mode .optimize-tab {
            background: var(--input-bg);
            border-color: var(--border-color);
            color: var(--text-primary);
        }

        html.dark-mode .optimize-tab.active {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }

        html.dark-mode .optimize-results-content {
            background: var(--input-bg);
        }

        html.dark-mode .optimize-result-item {
            color: var(--text-primary);
        }

        /* Message notification settings styles */
        .notification-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 20px !important;
            padding: 2px 0;
        }

        .notification-row > label:first-child {
            display: flex;
            align-items: center;
            gap: 70px;
            margin: 0 !important;
            white-space: nowrap;
            flex: 1;
        }

        .notification-row > label:first-child .checkbox-group {
            display: flex;
            margin: 0;
            white-space: nowrap;
            gap: 6px;
        }

        .notification-controls {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-left: auto;
            flex-shrink: 0;
        }

        .notification-controls .btn {
            flex-shrink: 0;
            font-size: 14px;
        }

        .btn-notification-config {
            background: linear-gradient(135deg, #8b5cf6 0, #7c3aed 100%);
            color: #fff;
            box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3);
        }

        .btn-notification-config::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left .5s ease;
        }

        .btn-notification-config:hover::before {
            left: 100%;
        }

        .btn-notification-config:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(139, 92, 246, 0.5);
        }

        .btn-notification-config:active {
            transform: translateY(0);
            box-shadow: 0 2px 10px rgba(139, 92, 246, 0.3);
        }

        .btn-clear-config {
            background: linear-gradient(135deg, #ef4444 0, #dc2626 100%);
            color: #fff;
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3);
        }

        .btn-clear-config::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left .5s ease;
        }

        .btn-clear-config:hover::before {
            left: 100%;
        }

        .btn-clear-config:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(239, 68, 68, 0.5);
        }

        .btn-clear-config:active {
            transform: translateY(0);
            box-shadow: 0 2px 10px rgba(239, 68, 68, 0.3);
        }

        html.dark-mode .btn-clear-config {
            background: linear-gradient(135deg, #ef4444 0, #dc2626 100%);
            color: #fff;
        }

        /* ==================== CF Usage Statistics Module Styles ==================== */

        .cf-usage-module {
            display: none;
        }

        .cf-usage-module[style*="display: block"] {
            display: block !important;
        }

        .cf-usage-wrapper {
            padding: 20px 0;
        }

        /* Statistics cards */
        .cf-stats-card {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(6, 182, 212, 0.1) 100%);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
            border-left: 4px solid #3b82f6;
        }

        .cf-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
        }

        .cf-stat-item {
            display: flex;
            flex-direction: column;
        }

        .cf-stat-label {
            font-size: 12px;
            color: #6b7280;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }

        .cf-stat-value {
            font-size: 24px;
            font-weight: 700;
        }

        .cf-value-green {
            color: #10b981;
        }

        .cf-value-blue {
            color: #3b82f6;
        }

        .cf-value-orange {
            color: #f59e0b;
        }

        .cf-progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .cf-progress-title {
            font-size: 13px;
            font-weight: 600;
            color: #1f2937;
        }

        .cf-percentage-badge {
            font-size: 13px;
            font-weight: 600;
            color: #f59e0b;
            background: rgba(245, 158, 11, 0.1);
            padding: 4px 12px;
            border-radius: 20px;
        }

        .cf-progress-bar {
            position: relative;
            height: 28px;
            background: linear-gradient(90deg, #9ca3af 0%, #6b7280 100%);
            border-radius: 14px;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.06);
        }

        .cf-bar-segment {
            position: absolute;
            height: 100%;
            border-radius: 0;
            width: 0%;
            transition: width 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
            display: flex;
            align-items: center;
            font-size: 11px;
            font-weight: 700;
            color: white;
        }

        .cf-bar-green {
            background: linear-gradient(90deg, #10b981 0%, #059669 100%);
            box-shadow: 0 0 12px rgba(16, 185, 129, 0.5);
            justify-content: flex-end;
            padding-right: 12px;
            opacity: 0.9;
        }

        .cf-bar-blue {
            background: linear-gradient(90deg, #3b82f6 0%, #1d4ed8 100%);
            box-shadow: 0 0 12px rgba(59, 130, 246, 0.5);
            justify-content: center;
            opacity: 0.85;
        }

        .cf-percentage-center {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 13px;
            font-weight: 700;
            color: white;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
        }

        /* Information prompt box */
        .cf-info-box {
            background: linear-gradient(135deg, rgba(249, 115, 22, 0.05) 0%, rgba(234, 179, 8, 0.05) 100%);
            border: 1px solid rgba(249, 115, 22, 0.2);
            border-radius: 8px;
            padding: 14px;
            margin-bottom: 0;
            display: flex;
            gap: 12px;
            align-items: flex-start;
        }

        .cf-info-icon {
            font-size: 16px;
            flex-shrink: 0;
        }

        .cf-info-text {
            font-size: 13px;
            color: #6b7280;
            line-height: 1.6;
        }

        .cf-info-text strong {
            color: #1f2937;
        }

        .cf-highlight {
            color: #f59e0b !important;
        }

        /* Countdown numbers style */
        .countdown-numbers {
            color: #f59e0b;
            font-weight: bold;
        }

        /* Countdown text style */
        .countdown-text {
            color: #6b7280;
        }

        /* Responsive layout: hide line breaks on desktop, show on mobile */
        @media (min-width: 768px) {
            .cf-info-text br {
                display: none;
            }

            .cf-info-text {
                white-space: nowrap;
            }
        }

        @media (max-width: 767px) {
            .cf-info-text br {
                display: block;
            }

            .cf-info-text {
                white-space: normal;
            }
        }

        /* ==================== Dark Mode Support ==================== */

        html.dark-mode .cf-stats-card {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.2) 0%, rgba(6, 182, 212, 0.2) 100%);
            border-left-color: #3b82f6;
        }

        html.dark-mode .cf-stat-label {
            color: var(--text-secondary);
        }

        html.dark-mode .cf-progress-title {
            color: var(--text-primary);
        }

        html.dark-mode .cf-percentage-badge {
            color: #fbbf24;
            background: rgba(251, 191, 36, 0.1);
        }

        html.dark-mode .cf-progress-bar {
            background: linear-gradient(90deg, #111827 0%, #0f172a 100%);
        }

        html.dark-mode .cf-percentage-center {
            color: white;
        }

        html.dark-mode .cf-info-box {
            background: linear-gradient(135deg, rgba(249, 115, 22, 0.1) 0%, rgba(234, 179, 8, 0.1) 100%);
            border-color: rgba(249, 115, 22, 0.3);
        }

        html.dark-mode .cf-info-text {
            color: var(--text-secondary);
        }

        html.dark-mode .cf-info-text strong {
            color: var(--text-primary);
        }

        html.dark-mode .cf-highlight {
            color: #fbbf24 !important;
        }

        /* Dark mode countdown numbers style */
        html.dark-mode .countdown-numbers {
            color: #fbbf24;
            font-weight: bold;
        }

        /* Dark mode countdown text style */
        html.dark-mode .countdown-text {
            color: #9ca3af;
        }

        html.dark-mode .qrcode-container {
            background: #FFFFFF;
        }

        /* Network information card styles */
        .port-info {
            margin-top: 30px;
            padding: 0 20px;
        }

        .port-info > h3 {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        html.dark-mode .port-info > h3 {
            color: #e0e0e0;
        }

        .network-cards-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin-bottom: 10px;
        }

        .network-card {
            background: rgba(255, 255, 255, 0.6);
            -webkit-backdrop-filter: blur(10px);
            backdrop-filter: blur(10px);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.08), 0 0 0 1px rgba(255, 255, 255, 0.1) inset;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
            position: relative;
            border-left: 4px solid transparent;
        }

        .network-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(250, 171, 65, 0.1), transparent);
            transition: left 0.5s;
        }

        .network-card:hover {
            box-shadow: 0 8px 12px rgba(0, 0, 0, 0.12), 0 0 12px rgba(250, 171, 65, 0.08);
            transform: translateY(-4px);
            border-left-color: #faab41;
        }

        .network-card:hover::before {
            left: 100%;
        }

        html.dark-mode .network-card {
            background: rgba(39, 39, 39, 0.7);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3), 0 0 0 1px rgba(255, 255, 255, 0.05) inset;
            border-left-color: transparent;
        }

        html.dark-mode .network-card:hover {
            box-shadow: 0 8px 12px rgba(0, 0, 0, 0.4), 0 0 12px rgba(250, 171, 65, 0.15);
            border-left-color: #faab41;
        }

        .network-card-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 12px;
            color: #333;
        }

        html.dark-mode .network-card-title {
            color: #e0e0e0;
        }

        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            animation: none;
        }

        .status-indicator.status-loading {
            background-color: #ffa500;
            box-shadow: 0 0 5px #ffa500;
            animation: pulse 1.5s infinite;
        }

        .status-indicator.status-success {
            background-color: #4caf50;
            box-shadow: 0 0 5px #4caf50;
        }

        .status-indicator.status-error {
            background-color: #f44336;
            box-shadow: 0 0 5px #f44336;
        }

        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }

        .network-info-content {
            padding-left: 20px;
        }

        .ip-text {
            font-size: 18px;
            font-weight: 700;
            color: #333;
            word-break: break-all;
            margin-bottom: 8px;
            cursor: default;
            transition: all 0.2s;
        }

        html.dark-mode .ip-text {
            color: #ffffff;
        }

        .ip-text.clickable {
            cursor: pointer;
            color: #2196F3;
        }

        .ip-text.clickable:hover {
            color: #1976D2;
        }

        html.dark-mode .ip-text.clickable {
            color: #64B5F6;
        }

        html.dark-mode .ip-text.clickable:hover {
            color: #90CAF9;
        }

        .ip-text .error {
            color: #f44336;
            font-size: 14px;
        }

        .location-text {
            display: flex;
            gap: 15px;
            margin-bottom: 8px;
            font-size: 14px;
            color: #666;
        }

        html.dark-mode .location-text {
            color: #b0b0b0;
        }

        .country-text,
        .city-text {
            flex: 1;
        }

        .network-tip {
            font-size: 12px;
            color: #999;
            margin-top: 8px;
        }

        html.dark-mode .network-tip {
            color: #999;
        }

        .loading-spinner {
            display: inline-block;
            width: 14px;
            height: 14px;
            border: 2px solid #f3f3f3;
            border-top: 2px solid #2196F3;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 8px;
            vertical-align: middle;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }

        /* IP detail popup styles */
        .ip-detail-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            padding: 20px;
            overflow-y: auto;
        }

        .ip-detail-content {
            background: white;
            border-radius: 12px;
            max-width: 700px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            position: relative;
            animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        html.dark-mode .ip-detail-content {
            background: #2c2c2c;
            color: #e0e0e0;
        }

        .ip-detail-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 28px;
            cursor: pointer;
            color: #666;
            transition: color 0.2s;
        }

        .ip-detail-close:hover {
            color: #f44336;
        }

        html.dark-mode .ip-detail-close {
            color: #b0b0b0;
        }

        .ip-detail-title {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 20px;
            color: #333;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        html.dark-mode .ip-detail-title {
            color: #ffffff;
        }

        .ip-detail-source {
            font-size: 12px;
            color: #999;
            font-weight: 400;
        }

        html.dark-mode .ip-detail-source {
            color: #999;
        }

        .ip-detail-section {
            margin-bottom: 20px;
            border-bottom: 1px solid #e0e0e0;
            padding-bottom: 20px;
        }

        html.dark-mode .ip-detail-section {
            border-bottom-color: #444;
        }

        .ip-detail-section:last-child {
            border-bottom: none;
        }

        .ip-detail-section-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 12px;
            color: #333;
        }

        html.dark-mode .ip-detail-section-title {
            color: #e0e0e0;
        }

        .ip-detail-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            font-size: 14px;
        }

        .ip-detail-label {
            color: #666;
            font-weight: 500;
            min-width: 120px;
        }

        html.dark-mode .ip-detail-label {
            color: #b0b0b0;
        }

        .ip-detail-value {
            text-align: right;
            color: #333;
            flex: 1;
            word-break: break-all;
        }

        html.dark-mode .ip-detail-value {
            color: #e0e0e0;
        }

        .ip-detail-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 16px;
            font-size: 12px;
            font-weight: 600;
            text-align: center;
        }

        .badge-success {
            background-color: #e8f5e9;
            color: #2e7d32;
        }

        .badge-info {
            background-color: #e3f2fd;
            color: #1565c0;
        }

        .badge-warning {
            background-color: #fff3e0;
            color: #e65100;
        }

        .badge-danger {
            background-color: #ffebee;
            color: #c62828;
        }

        .badge-high {
            background-color: #ffe0b2;
            color: #e65100;
        }

        .badge-critical {
            background-color: #ffcdd2;
            color: #b71c1c;
        }

        .badge-elevated {
            background-color: #fff9c4;
            color: #f57f17;
        }

        .badge-low {
            background-color: #c8e6c9;
            color: #1b5e20;
        }

        .badge-verylow {
            background-color: #a5d6a7;
            color: #00320c;
        }

        html.dark-mode .badge-success {
            background-color: #1b5e20;
            color: #81c784;
        }

        html.dark-mode .badge-info {
            background-color: #0d47a1;
            color: #64b5f6;
        }

        html.dark-mode .badge-warning {
            background-color: #e65100;
            color: #ffb74d;
        }

        html.dark-mode .badge-danger {
            background-color: #b71c1c;
            color: #ef5350;
        }

        /* Risk level text styles */
        .success-text {
            color: #2e7d32;
        }

        .warning-text {
            color: #e65100;
        }

        .danger-text {
            color: #c62828;
        }

        html.dark-mode .success-text {
            color: #81c784;
        }

        html.dark-mode .warning-text {
            color: #ffb74d;
        }

        html.dark-mode .danger-text {
            color: #ef5350;
        }

        /* Score algorithm explanation bubble */
        .score-help-icon {
            display: inline-block;
            width: 18px;
            height: 18px;
            line-height: 18px;
            text-align: center;
            background-color: #2196F3;
            color: white;
            border-radius: 50%;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
            transition: background-color 0.2s;
        }

        .score-help-icon:hover {
            background-color: #1976D2;
        }

        html.dark-mode .score-help-icon {
            background-color: #1976D2;
        }

        html.dark-mode .score-help-icon:hover {
            background-color: #64B5F6;
        }

        .score-tooltip {
            display: none;
            position: absolute;
            bottom: 100%;
            right: 0;
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            min-width: 300px;
            max-width: 350px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1001;
            font-size: 13px;
            line-height: 1.6;
        }

        /* Bubble position adjustment classes */
        .score-tooltip.tooltip-bottom {
            bottom: auto;
            top: calc(100% + 10px);
        }

        .score-tooltip.tooltip-left {
            right: auto;
            left: -350px;
        }

        .score-tooltip.tooltip-right {
            left: auto;
            right: -350px;
        }

        html.dark-mode .score-tooltip {
            background: #3c3c3c;
            border-color: #444;
            color: #e0e0e0;
        }

        .score-tooltip.show {
            display: block;
        }

        .tooltip-header {
            font-weight: bold;
            margin-bottom: 10px;
            border-bottom: 1px solid #e0e0e0;
            padding-bottom: 10px;
        }

        html.dark-mode .tooltip-header {
            border-bottom-color: #444;
        }

        .tooltip-section {
            margin-top: 10px;
        }

        .tooltip-section-title {
            font-weight: 600;
            margin-bottom: 8px;
        }

        .formula-item {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
            padding-left: 10px;
        }

        .formula-equation code {
            background-color: #f5f5f5;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 12px;
        }

        html.dark-mode .formula-equation code {
            background-color: #444;
        }

        .risk-list {
            list-style: none;
            padding-left: 0;
        }

        .risk-list li {
            padding: 4px 0;
            padding-left: 20px;
            position: relative;
        }

        .risk-list li::before {
            content: '';
            position: absolute;
            left: 0;
        }

        /* Responsive design */
        @media (max-width: 1024px) {
            .network-cards-container {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .network-cards-container {
                grid-template-columns: 1fr;
            }

            .ip-detail-content {
                padding: 20px;
                max-width: 100%;
            }

            .ip-detail-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }

            .ip-detail-label {
                min-width: unset;
            }

            .ip-detail-value {
                text-align: left;
                width: 100%;
            }

            .score-tooltip {
                position: fixed;
                bottom: auto;
                right: auto;
                left: 50%;
                top: 50%;
                transform: translate(-50%, -50%);
                min-width: 280px;
                max-width: 90%;
            }
        }
    </style>
</head>

<body>
    <!-- Background content -->
    <iframe id="background-iframe" src="/" title="Background content"></iframe>

    <!-- Blur effect overlay -->
    <div id="blur-overlay"></div>

    <!-- Management dashboard container -->
    <div class="page-wrapper">
        <div class="card-container">
            <div class="success-message" id="successMsg"></div>
            <div class="error-message" id="errorMsg"></div>

            <div class="header">
                <div class="header-title">
                    <h1 id="pageTitle">Loading...</h1>
                </div>
                <div class="header-buttons">
                    <button type="button" class="btn btn-danger btn-reset" onclick="resetConfigWithConfirm()"> Reset Configuration</button>
                    <button type="button" class="btn btn-primary" onclick="logout()"> Logout</button>
                </div>
            </div>

            <!-- Cloudflare Workers/Pages Usage Statistics Module -->
            <div class="module cf-usage-module collapsed" id="cfUsageModule">
                <div class="module-title" onclick="toggleModule(this)">
                    Workers/Pages Request Usage
                    <svg class="collapse-icon" viewBox="0 0 24 24">
                        <path d="M7 10l5 5 5-5z" />
                    </svg>
                </div>
                <!-- Progress bar -->
                <div>
                    <div class="cf-progress-bar">
                        <!-- Workers progress bar (green) -->
                        <div class="cf-bar-segment cf-bar-green" id="cfWorkerBar" title="Workers Requests"></div>
                        <!-- Pages progress bar (blue) -->
                        <div class="cf-bar-segment cf-bar-blue" id="cfPagesBar" title="Pages Requests"></div>
                        <!-- Overall percentage text (center) -->
                        <div class="cf-percentage-center" id="cfPercentageCenter">0%</div>
                    </div>
                </div>
                <div class="module-content">
                    <div class="cf-usage-wrapper">
                        <!-- Usage statistics card -->
                        <div class="cf-stats-card">
                            <div class="cf-stats-grid">
                                <div class="cf-stat-item">
                                    <div class="cf-stat-label">Workers Requests</div>
                                    <div class="cf-stat-value cf-value-green" id="cfWorkerCount">-</div>
                                </div>
                                <div class="cf-stat-item">
                                    <div class="cf-stat-label">Pages Requests</div>
                                    <div class="cf-stat-value cf-value-blue" id="cfPagesCount">-</div>
                                </div>
                                <div class="cf-stat-item">
                                    <div class="cf-stat-label">Daily Quota</div>
                                    <div class="cf-stat-value cf-value-orange">100,000</div>
                                </div>
                            </div>
                        </div>

                        <!-- Information prompt -->
                        <div class="cf-info-box">
                            <div class="cf-info-icon"></div>
                            <div class="cf-info-text">
                                <strong>Daily request count reset:</strong><br><span id="countdown" class="cf-highlight">Resets in 15 hours 24 minutes 34 seconds</span>,<br>Beijing Time (UTC+8) <strong class="cf-highlight">8:00</strong> reset,<br>Today's total usage: <strong class="cf-highlight" id="cfTotalDisplay">-</strong>.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Network Information Module -->
            <div class="module">
                <div class="module-title">
                     Current Network Information
                </div>
                <div class="module-content">
                    <div class="network-cards-container">
                        <div class="network-card">
                            <div class="network-card-title">
                                <span class="status-indicator" id="status-ipip"></span>
                                Domestic Test
                            </div>
                            <div class="network-info-content">
                                <span id="ipip-ip" class="ip-text">-</span>
                                <div class="location-text">
                                    <span id="ipip-country" class="country-text">-</span>
                                </div>
                                <div class="network-tip"> IP used to access domestic sites</div>
                            </div>
                        </div>

                        <div class="network-card">
                            <div class="network-card-title">
                                <span class="status-indicator" id="status-edgeone"></span>
                                International Test
                            </div>
                            <div class="network-info-content">
                                <span id="edgeone-ip" class="ip-text">-</span>
                                <div class="location-text">
                                    <span id="edgeone-country" class="country-text">-</span>
                                </div>
                                <div class="network-tip"> IP used to access non-blocked international sites</div>
                            </div>
                        </div>

                        <div class="network-card">
                            <div class="network-card-title">
                                <span class="status-indicator" id="status-cf"></span>
                                CloudFlare (ProxyIP)
                            </div>
                            <div class="network-info-content">
                                <span id="cf-ip" class="ip-text">-</span>
                                <div class="location-text">
                                    <span id="cf-country" class="country-text">-</span>
                                </div>
                                <div class="network-tip"> Landing IP used to access CF CDN sites</div>
                            </div>
                        </div>

                        <div class="network-card">
                            <div class="network-card-title">
                                <span class="status-indicator" id="status-twitter"></span>
                                Twitter/X
                            </div>
                            <div class="network-info-content">
                                <span id="twitter-ip" class="ip-text">-</span>
                                <div class="location-text">
                                    <span id="twitter-country" class="country-text">-</span>
                                </div>
                                <div class="network-tip"> IP used to access Twitter (x.com)</div>
                            </div>
                        </div>
                    </div>
                    <small style="font-size: 12px; color: #9ca3af; margin-top: 6px; display: block;"> <b>Domestic Test</b> is determined by your proxy's <b>routing rules</b>, <b>International Test</b> is determined by your <b>optimized IP</b>, while <b>CF, Twitter, ChatGPT</b> are determined by your <b>PROXYIP</b>.</small>
                </div>
            </div>

            <!-- Module 1: Subscription Links -->
            <div class="module">
                <div class="module-title" onclick="toggleModule(this)">
                     Get Node Links
                    <svg class="collapse-icon" viewBox="0 0 24 24">
                        <path d="M7 10l5 5 5-5z" />
                    </svg>
                </div>
                <div class="form-group">
                    <label for="LinkURL">Node Link Format</label>
                    <div class="input-wrapper">
                        <input type="text" id="LinkURL" title="Node Link Format" readonly>
                        <button type="button" class="btn btn-qrcode" onclick="showQRCode('LinkURL')"> QR Code</button>
                        <button type="button" class="btn btn-primary" onclick="copySubscription('LinkURL')">Copy Node</button>
                    </div>
                </div>
                <div class="form-group">
                    <label for="subLink">Adaptive Subscription</label>
                    <div class="input-wrapper">
                        <input type="text" id="subLink" title="Adaptive Subscription" readonly>
                        <button type="button" class="btn btn-qrcode" onclick="showQRCode('subLink')"> QR Code</button>
                        <button type="button" class="btn btn-primary" onclick="copySubscription('subLink')">Copy Subscription</button>
                    </div>
                </div>
                <div class="module-content">
                    <div class="form-group">
                        <label for="base64Link">Base64 Subscription</label>
                        <div class="input-wrapper">
                            <input type="text" id="base64Link" title="Base64 Subscription" readonly>
                            <button type="button" class="btn btn-qrcode" onclick="showQRCode('base64Link')"> QR Code</button>
                            <button type="button" class="btn btn-primary" onclick="copySubscription('base64Link')">Copy Subscription</button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="clashLink">Clash Subscription</label>
                        <div class="input-wrapper">
                            <input type="text" id="clashLink" title="Clash Subscription" readonly>
                            <button type="button" class="btn btn-qrcode" onclick="showQRCode('clashLink')"> QR Code</button>
                            <button type="button" class="btn btn-primary" onclick="copySubscription('clashLink')">Copy Subscription</button>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="singboxLink">SingBox Subscription</label>
                        <div class="input-wrapper">
                            <input type="text" id="singboxLink" title="SingBox Subscription" readonly>
                            <button type="button" class="btn btn-qrcode" onclick="showQRCode('singboxLink')"> QR Code</button>
                            <button type="button" class="btn btn-primary" onclick="copySubscription('singboxLink')">Copy Subscription</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Module 2: Edit Subscription Generation -->
            <div class="module collapsed">
                <div class="module-title" onclick="toggleModule(this)">
                     Optimized Subscription Generation
                    <svg class="collapse-icon" viewBox="0 0 24 24">
                        <path d="M7 10l5 5 5-5z" />
                    </svg>
                </div>
                <div class="module-content">

                    <div class="form-group">
                        <label for="ipMode">Optimized Subscription Mode</label>
                        <select id="ipMode" title="Optimized Subscription Mode" onchange="updateIPMode()">
                            <option value="random">Random Optimization</option>
                            <option value="custom">Custom Optimization</option>
                            <option value="generator">Optimized Subscription Generator</option>
                        </select>
                    </div>

                    <div id="randomIPSection" class="form-group">
                        <label for="randomCount">Random Optimization Count</label>
                        <input type="number" id="randomCount" title="Random Optimization Count" min="1" max="999" value="16" onchange="markModified('sub')">
                    </div>

                    <div id="customIPSection" class="form-group hidden-section">
                        <label for="customIPs">Custom Optimized Addresses</label>
                        <textarea id="customIPs" title="Custom Optimized Addresses" placeholder="Note:
One address per line, e.g.: address:port#remark
IPv6 addresses need to be enclosed in brackets, e.g.: [2606:4700::]:2053
If port is not specified, default is 443, e.g.: www.visa.com#Optimized Domain

Examples:
www.visa.com#Optimized Domain
127.0.0.1:1234#CFnat
[2606:4700::]:2053#IPv6

API Examples:
https://raw.githubusercontent.com/cmliu/WorkerVless2sub/main/addressesapi.txt"
                            onchange="markModified('sub')"></textarea>
                    </div>

                    <div id="generatorSection" class="form-group hidden-section">
                        <label for="generatorURL">Optimized Subscription Generator</label>
                        <input type="text" id="generatorURL" title="Optimized Subscription Generator" placeholder="sub.cmliussss.net" onchange="processGeneratorURL()" oninput="processGeneratorURL()">
                    </div>

                    <div class="module-footer">
                        <button type="button" class="btn btn-online-optimize hidden-section" id="onlineOptimizeBtn" onclick="openOnlineOptimizeModal()">Online Optimization</button>
                        <button type="button" class="btn btn-api-optimize hidden-section" id="apiOptimizeBtn" onclick="openAPIOptimizeModal()">Optimization API</button>
                        <div class="btn-group">
                            <button type="button" class="btn btn-secondary" onclick="cancelEdit('sub')" disabled id="cancelSubBtn">Cancel</button>
                            <button type="button" class="btn btn-primary" onclick="saveSub()" disabled id="saveSubBtn">Save</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Module 3: Detailed Configuration Information -->
            <div class="module collapsed">
                <div class="module-title" onclick="toggleModule(this)">
                     Detailed Configuration Information
                    <svg class="collapse-icon" viewBox="0 0 24 24">
                        <path d="M7 10l5 5 5-5z" />
                    </svg>
                </div>
                <div class="module-content">

                    <div class="form-group">
                        <label for="subName">Subscription Name</label>
                        <input type="text" id="subName" title="Subscription Name" onchange="markModified('config')">
                    </div>

                    <div class="form-group">
                        <label for="nodeHost">Node Domain</label>
                        <input type="text" id="nodeHost" title="Node Domain" readonly>
                    </div>

                    <div class="form-group">
                        <label for="nodeUUID">UUID</label>
                        <input type="text" id="nodeUUID" title="UUID" readonly>
                    </div>

                    <div class="form-group">
                        <label for="protocol">Node Protocol</label>
                        <select id="protocol" title="Node Protocol" onchange="updateProtocol(); markModified('config')">
                            <option value="vless">VLESS</option>
                            <option value="trojan">Trojan</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="skipVerify">Skip Certificate Verification</label>
                        <div class="input-wrapper">
                            <div class="checkbox-group">
                                <input type="checkbox" id="skipVerify" title="Skip Certificate Verification" onchange="markModified('config')">
                                <label for="skipVerify" class="checkbox-label">Enable</label>
                            </div>
                        </div>
                    </div>

                    <div class="module-footer">
                        <div class="btn-group">
                            <button type="button" class="btn btn-secondary" onclick="cancelEdit('config')" disabled id="cancelConfigBtn">Cancel</button>
                            <button type="button" class="btn btn-primary" onclick="saveConfig()" disabled id="saveConfigBtn">Save</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Module 4: Reverse Proxy Settings -->
            <div class="module collapsed">
                <div class="module-title" onclick="toggleModule(this)">
                     Cloudflare CDN Access Settings
                    <svg class="collapse-icon" viewBox="0 0 24 24">
                        <path d="M7 10l5 5 5-5z" />
                    </svg>
                </div>
                <div class="module-content">

                    <div class="form-group">
                        <label for="proxyMode">Reverse Proxy Mode</label>
                        <select id="proxyMode" title="Reverse Proxy Mode" onchange="updateProxyMode()">
                            <option value="auto">PROXYIP</option>
                            <option value="socks5">SOCKS5</option>
                            <option value="http">HTTP</option>
                        </select>
                    </div>

                    <div id="proxyIPSection" class="form-group">
                        <div class="form-group">
                            <label for="proxyIP">PROXYIP</label>
                            <div class="input-wrapper">
                                <input type="text" id="proxyIP" title="PROXYIP" placeholder="proxyip.cmliussss.net" onchange="processProxyIP()" oninput="processProxyIP()">
                                <div class="checkbox-group">
                                    <input type="checkbox" id="autoProxy" title="Enable Auto Fetch" onchange="toggleAutoProxy(); markModified('proxy')">
                                    <label for="autoProxy" class="checkbox-label">Enable Auto Fetch</label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="socks5Section" class="hidden-section">
                        <div class="form-group">
                            <label for="socks5Addr">SOCKS5</label>
                            <div class="input-wrapper">
                                <input type="text" id="socks5Addr" title="SOCKS5" placeholder="user:password@127.0.0.1:1080" onchange="processProxyAddress('socks5')" oninput="processProxyAddress('socks5')">
                                <div class="checkbox-group">
                                    <input type="checkbox" id="globalSocks5" title="Enable Global Proxy" onchange="markModified('proxy')">
                                    <label for="globalSocks5" class="checkbox-label">Enable Global Proxy</label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="httpSection" class="hidden-section">
                        <div class="form-group">
                            <label for="httpAddr">HTTP</label>
                            <div class="input-wrapper">
                                <input type="text" id="httpAddr" title="HTTP" placeholder="user:password@127.0.0.1:8080" onchange="processProxyAddress('http')" oninput="processProxyAddress('http')">
                                <div class="checkbox-group">
                                    <input type="checkbox" id="globalHTTP" title="Enable Global Proxy" onchange="markModified('proxy')">
                                    <label for="globalHTTP" class="checkbox-label">Enable Global Proxy</label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="module-footer">
                        <button type="button" class="btn btn-proxyip-help" onclick="showProxyIPHelpModal()" title="Learn about ProxyIP">
                             Why do we need reverse proxy mode? What is PROXYIP?
                        </button>
                        <div class="btn-group">
                            <button type="button" class="btn btn-secondary" onclick="cancelEdit('proxy')" disabled id="cancelProxyBtn">Cancel</button>
                            <button type="button" class="btn btn-primary" onclick="saveProxy()" disabled id="saveProxyBtn">Save</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Module 5: Subscription Conversion Configuration -->
            <div class="module collapsed">
                <div class="module-title" onclick="toggleModule(this)">
                     Subscription Conversion Configuration
                    <svg class="collapse-icon" viewBox="0 0 24 24">
                        <path d="M7 10l5 5 5-5z" />
                    </svg>
                </div>
                <div class="module-content">

                    <div class="form-group">
                        <label for="subAPI">Subscription Conversion Backend</label>
                        <div class="readonly-wrapper" onclick="openSubAPIModal()">
                            <input type="text" id="subAPI" title="Subscription Conversion Backend" readonly placeholder="https://SUBAPI.cmliussss.net" class="subapi-input">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="subConfig">Subscription Conversion Config File</label>
                        <input type="text" id="subConfig" title="Subscription Conversion Config File" placeholder="https://raw.githubusercontent.com/..." onchange="markModified('convert')">
                    </div>

                    <div class="form-group">
                        <label for="emoji">Emoji</label>
                        <div class="input-wrapper">
                            <div class="checkbox-group">
                                <input type="checkbox" id="emoji" title="Enable Emoji" onchange="markModified('convert')">
                                <label for="emoji" class="checkbox-label">Enable</label>
                            </div>
                        </div>
                    </div>

                    <div class="module-footer">
                        <div class="btn-group">
                            <button type="button" class="btn btn-secondary" onclick="cancelEdit('convert')" disabled id="cancelConvertBtn">Cancel</button>
                            <button type="button" class="btn btn-primary" onclick="saveConvert()" disabled id="saveConvertBtn">Save</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Module 6: Message Notification Settings -->
            <div class="module collapsed">
                <div class="module-title" onclick="toggleModule(this)">
                     Message Notification Settings
                    <svg class="collapse-icon" viewBox="0 0 24 24">
                        <path d="M7 10l5 5 5-5z" />
                    </svg>
                </div>
                <div class="module-content">

                    <!-- Telegram Bot Notification Settings -->
                    <div class="form-group notification-row">
                        <label>
                            Telegram Bot Notification Settings
                            <div class="checkbox-group">
                                <input type="checkbox" id="telegramEnabled" title="Enable Telegram Bot Notifications" onchange="markModified('notification')" disabled>
                                <label for="telegramEnabled" class="checkbox-label">Enable</label>
                            </div>
                        </label>
                        <div class="notification-controls">
                            <button type="button" class="btn btn-notification-config" onclick="openTelegramConfigModal()"> Parameter Configuration</button>
                            <button type="button" class="btn btn-clear-config" onclick="clearTelegramConfig()"> Clear Configuration</button>
                        </div>
                    </div>

                    <!-- Cloudflare Available Request Count Statistics -->
                    <div class="form-group notification-row">
                        <label>
                            Cloudflare Workers/Pages Available Request Count Statistics
                        </label>
                        <div class="notification-controls">
                            <button type="button" class="btn btn-notification-config" onclick="openCloudflareConfigModal()"> Parameter Configuration</button>
                            <button type="button" class="btn btn-clear-config" onclick="clearCloudflareConfig()"> Clear Configuration</button>
                        </div>
                    </div>

                    <div class="module-footer">
                        <div class="btn-group">
                            <button type="button" class="btn btn-secondary" onclick="cancelEdit('notification')" disabled id="cancelNotificationBtn">Cancel</button>
                            <button type="button" class="btn btn-primary" onclick="saveNotification()" disabled id="saveNotificationBtn">Save</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Module 7: View All Logs -->
            <div class="module collapsed">
                <div class="module-title" onclick="toggleModule(this); loadLogsOnExpand(this)">
                     View Operation Logs
                    <svg class="collapse-icon" viewBox="0 0 24 24">
                        <path d="M7 10l5 5 5-5z" />
                    </svg>
                </div>
                <div class="module-content">
                    <div id="logsContainer" class="logs-container">
                        <div class="logs-loading">Loading...</div>
                    </div>
                    <div class="logs-footer">
                        <p class="logs-footer-text">Due to limited KV space, only 4MB of operation logs are retained. When the log size exceeds this capacity, the oldest log records will be automatically cleaned.</p>
                        <button type="button" class="btn btn-primary btn-all-logs" onclick="showAllLogs()">All Logs</button>
                    </div>
                </div>
            </div>

            <div class="social-links">
                <a href="https://github.com/cmliu/edgetunnel" target="_blank" rel="noopener" class="social-link" title="GitHub">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
                        <path fill="currentColor" fill-rule="evenodd"
                            d="M7.976 0A7.977 7.977 0 0 0 0 7.976c0 3.522 2.3 6.507 5.431 7.584c.392.049.538-.196.538-.392v-1.37c-2.201.49-2.69-1.076-2.69-1.076c-.343-.93-.881-1.175-.881-1.175c-.734-.489.048-.489.048-.489c.783.049 1.224.832 1.224.832c.734 1.223 1.859.88 2.3.685c.048-.538.293-.88.489-1.076c-1.762-.196-3.621-.881-3.621-3.964c0-.88.293-1.566.832-2.153c-.05-.147-.343-.978.098-2.055c0 0 .685-.196 2.201.832c.636-.196 1.322-.245 2.007-.245s1.37.098 2.006.245c1.517-1.027 2.202-.832 2.202-.832c.44 1.077.146 1.908.097 2.104a3.16 3.16 0 0 1 .832 2.153c0 3.083-1.86 3.719-3.62 3.915c.293.244.538.733.538 1.467v2.202c0 .196.146.44.538.392A7.98 7.98 0 0 0 16 7.976C15.951 3.572 12.38 0 7.976 0"
                            clip-rule="evenodd" />
                    </svg>
                </a>
                <a href="https://t.me/CMLiussss" target="_blank" rel="noopener" class="social-link" title="Telegram">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256">
                        <defs>
                            <linearGradient id="telegramGradient" x1="50%" x2="50%" y1="0%" y2="100%">
                                <stop offset="0%" stop-color="#2AABEE" />
                                <stop offset="100%" stop-color="#229ED9" />
                            </linearGradient>
                        </defs>
                        <path fill="url(#telegramGradient)"
                            d="M128 0C94.06 0 61.48 13.494 37.5 37.49A128.04 128.04 0 0 0 0 128c0 33.934 13.5 66.514 37.5 90.51C61.48 242.506 94.06 256 128 256s66.52-13.494 90.5-37.49c24-23.996 37.5-56.576 37.5-90.51s-13.5-66.514-37.5-90.51C194.52 13.494 161.94 0 128 0" />
                        <path fill="#FFF"
                            d="M57.94 126.648q55.98-24.384 74.64-32.152c35.56-14.786 42.94-17.354 47.76-17.441c1.06-.017 3.42.245 4.96 1.49c1.28 1.05 1.64 2.47 1.82 3.467c.16.996.38 3.266.2 5.038c-1.92 20.24-10.26 69.356-14.5 92.026c-1.78 9.592-5.32 12.808-8.74 13.122c-7.44.684-13.08-4.912-20.28-9.63c-11.26-7.386-17.62-11.982-28.56-19.188c-12.64-8.328-4.44-12.906 2.76-20.386c1.88-1.958 34.64-31.748 35.26-34.45c.08-.338.16-1.598-.6-2.262c-.74-.666-1.84-.438-2.64-.258c-1.14.256-19.12 12.152-54 35.686c-5.1 3.508-9.72 5.218-13.88 5.128c-4.56-.098-13.36-2.584-19.9-4.708c-8-2.606-14.38-3.984-13.82-8.41c.28-2.304 3.46-4.662 9.52-7.072" />
                    </svg>
                </a>
                <button type="button" class="social-link theme-toggle" id="themeToggle" title="Toggle Dark Mode" onclick="toggleTheme()">
                    <!-- Sun icon (shown in light mode) -->
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="theme-icon sun-icon">
                        <circle cx="12" cy="12" r="5" fill="currentColor" />
                        <g stroke="currentColor" stroke-width="2" stroke-linecap="round" fill="none">
                            <line x1="12" y1="1" x2="12" y2="3" />
                            <line x1="12" y1="21" x2="12" y2="23" />
                            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" />
                            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" />
                            <line x1="1" y1="12" x2="3" y2="12" />
                            <line x1="21" y1="12" x2="23" y2="12" />
                            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" />
                            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" />
                        </g>
                    </svg>
                    <!-- Moon icon (shown in dark mode) -->
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="theme-icon moon-icon">
                        <path fill="currentColor" d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" />
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <!-- QR Code Popup -->
    <div class="modal-overlay" id="qrcodeModal" onclick="closeQRCode(event)">
        <div class="modal" onclick="event.stopPropagation()">
            <button type="button" class="modal-close" onclick="closeQRCode()"></button>
            <div id="qrcodeContainer" class="qrcode-container"></div>
            <button type="button" class="btn btn-primary btn-close-modal" onclick="closeQRCode()">Close</button>
        </div>
    </div>

    <!-- Reset Configuration Confirmation Popup -->
    <div class="modal-overlay" id="resetModal" onclick="closeResetModal(event)">
        <div class="modal" onclick="event.stopPropagation()">
            <h2 class="reset-modal-title"> Reset Configuration</h2>
            <p class="reset-modal-description">Resetting configuration will initialize all settings, including subscription generation, node information, reverse proxy configuration, etc. This operation cannot be undone, please proceed with caution.</p>
            <p class="reset-modal-confirm">Are you sure you want to completely reset the configuration?</p>
            <div class="reset-modal-buttons">
                <button type="button" class="btn btn-primary btn-confirm-reset" onclick="confirmReset()">Confirm Reset</button>
                <button type="button" class="btn btn-secondary" onclick="closeResetModal()">Cancel Reset</button>
            </div>
        </div>
    </div>

    <!-- Clear Telegram Configuration Confirmation Popup -->
    <div class="modal-overlay" id="clearTelegramModal" onclick="closeClearTelegramModal(event)">
        <div class="modal" onclick="event.stopPropagation()">
            <h2 class="reset-modal-title"> Clear Telegram Configuration</h2>
            <p class="reset-modal-description">Clearing Telegram Bot notification configuration will stop Telegram message notifications. This operation cannot be undone, please proceed with caution.</p>
            <p class="reset-modal-confirm">Are you sure you want to clear Telegram notification configuration?</p>
            <div class="reset-modal-buttons">
                <button type="button" class="btn btn-primary btn-confirm-reset" onclick="confirmClearTelegramConfig()">Confirm Clear</button>
                <button type="button" class="btn btn-secondary" onclick="closeClearTelegramModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Clear Cloudflare Configuration Confirmation Popup -->
    <div class="modal-overlay" id="clearCloudflareModal" onclick="closeClearCloudflareModal(event)">
        <div class="modal" onclick="event.stopPropagation()">
            <h2 class="reset-modal-title"> Clear Cloudflare Configuration</h2>
            <p class="reset-modal-description">Clearing Cloudflare configuration will stop Workers/Pages request count statistics. This operation cannot be undone, please proceed with caution.</p>
            <p class="reset-modal-confirm">Are you sure you want to clear Cloudflare notification configuration?</p>
            <div class="reset-modal-buttons">
                <button type="button" class="btn btn-primary btn-confirm-reset" onclick="confirmClearCloudflareConfig()">Confirm Clear</button>
                <button type="button" class="btn btn-secondary" onclick="closeClearCloudflareModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Logs View Popup -->
    <div class="modal-overlay" id="logsModal" onclick="closeLogsModal(event)">
        <div class="modal logs-modal" onclick="event.stopPropagation()">
            <button type="button" class="modal-close" onclick="closeLogsModal()"></button>
            <h2 class="logs-modal-title"> All Operation Logs</h2>
            <div id="allLogsContainer" class="logs-all-container"></div>
            <button type="button" class="btn btn-primary btn-close-modal" onclick="closeLogsModal()">Close</button>
        </div>
    </div>

    <!-- Subscription Conversion Backend Settings Popup -->
    <div class="modal-overlay" id="subAPIModal" onclick="closeSubAPIModal(event)">
        <div class="modal" onclick="event.stopPropagation()">
            <button type="button" class="modal-close" onclick="closeSubAPIModal()"></button>
            <h2 class="subapi-modal-title"> Subscription Conversion Backend</h2>
            <div class="form-group subapi-form-group">
                <label>Subscription Conversion Backend Address</label>
                <input type="text" id="testSubAPIInput" placeholder="Enter subscription conversion backend address">
            </div>
            <div id="subAPIStatus" class="subapi-status"></div>
            <div class="subapi-buttons">
                <button type="button" class="btn btn-primary btn-test-api" onclick="testSubAPI()">Availability Check</button>
                <button type="button" class="btn btn-primary btn-confirm-api" id="subAPIConfirmBtn" onclick="confirmSubAPI()" disabled>Confirm</button>
                <button type="button" class="btn btn-secondary btn-cancel-api" onclick="closeSubAPIModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- TelegramBot Notification Settings Popup -->
    <div class="modal-overlay" id="telegramConfigModal" onclick="closeTelegramConfigModal(event)">
        <div class="modal" onclick="event.stopPropagation()">
            <button type="button" class="modal-close" onclick="closeTelegramConfigModal()"></button>
            <h2 class="subapi-modal-title"> TelegramBot Notification Parameter Configuration</h2>
            <div class="form-group subapi-form-group">
                <label>Bot Token</label>
                <input type="text" id="telegramBotToken" placeholder="Enter Telegram Bot Token">
            </div>
            <div class="form-group subapi-form-group">
                <label>Chat ID</label>
                <input type="text" id="telegramChatID" placeholder="Enter Chat ID">
            </div>
            <div id="telegramStatus" class="subapi-status"></div>
            <div class="subapi-buttons">
                <button type="button" class="btn btn-primary btn-test-api" onclick="testTelegramConfig()">Availability Check</button>
                <button type="button" class="btn btn-primary btn-confirm-api" id="telegramConfirmBtn" onclick="confirmTelegramConfig()" disabled>Save</button>
                <button type="button" class="btn btn-secondary btn-cancel-api" onclick="closeTelegramConfigModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Cloudflare Notification Settings Popup -->
    <div class="modal-overlay" id="cloudflareConfigModal" onclick="closeCloudflareConfigModal(event)">
        <div class="modal" onclick="event.stopPropagation()">
            <button type="button" class="modal-close" onclick="closeCloudflareConfigModal()"></button>
            <h2 class="subapi-modal-title"> Workers/Pages Available Request Count Statistics</h2>

            <!-- Request scheme selection -->
            <div class="form-group subapi-form-group">
                <label>Request Scheme</label>
                <select id="cloudflareAuthMethod" title="Request Scheme" onchange="updateCloudflareAuthMethod()">
                    <option value="accountid">Account ID + API Token</option>
                    <option value="email">Email + Global API Key</option>
                </select>
            </div>

            <!-- Email + Global API Key scheme -->
            <div id="cloudflareEmailSection">
                <div class="form-group subapi-form-group">
                    <label>Email</label>
                    <input type="text" id="cloudflareEmail" placeholder="Enter Cloudflare account email">
                </div>
                <div class="form-group subapi-form-group">
                    <label>Global API Key</label>
                    <input type="password" id="cloudflareGlobalAPIKey" placeholder="Enter Global API Key">
                </div>
            </div>

            <!-- Account ID + API Token scheme -->
            <div id="cloudflareAccountIDSection" class="hidden-section">
                <div class="form-group subapi-form-group">
                    <label>Account ID</label>
                    <input type="text" id="cloudflareAccountID" placeholder="Enter Account ID">
                </div>
                <div class="form-group subapi-form-group">
                    <label>API Token</label>
                    <input type="password" id="cloudflareAPIToken" placeholder="Enter API Token">
                    <small style="font-size: 12px; color: #9ca3af; margin-top: 6px; display: block;"> API token permissions: Use "Read Analytics and Logs" template</small>
                </div>
            </div>

            <!-- Verification status prompt -->
            <div id="cloudflareStatus" class="subapi-status"></div>

            <!-- Button group -->
            <div class="subapi-buttons">
                <button type="button" class="btn btn-primary btn-test-api" onclick="testCloudflareConfig()">Availability Check</button>
                <button type="button" class="btn btn-primary btn-confirm-api" id="cloudflareConfirmBtn" onclick="confirmCloudflareConfig()" disabled>Save</button>
                <button type="button" class="btn btn-secondary btn-cancel-api" onclick="closeCloudflareConfigModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Online Optimization Popup -->
    <div class="modal-overlay" id="onlineOptimizeModal" onclick="closeOnlineOptimizeModal(event)">
        <div class="modal optimize-modal" onclick="event.stopPropagation()">
            <button type="button" class="modal-close" onclick="closeOnlineOptimizeModal()"></button>
            <h2 class="optimize-modal-title"> Online Optimization</h2>

            <!-- IP detection information -->
            <div id="ipDetectionBox" class="ip-detection-box">
                <div class="ip-detection-info">
                    Detecting your network environment...
                </div>
            </div>

            <!-- Parameter selection -->
            <div class="optimize-params-row">
                <div class="form-group">
                    <label for="optimizeIPLibrary">IP Library:</label>
                    <select id="optimizeIPLibrary">
                        <option value="cf-official">CF Official List</option>
                        <option value="cm-list">CM Organized List</option>
                        <option value="as13335">AS13335 List</option>
                        <option value="as209242">AS209242 List</option>
                        <option value="reverse-proxy">Reverse Proxy List</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="optimizePort">Port:</label>
                    <select id="optimizePort">
                        <option value="443">443</option>
                        <option value="2053">2053</option>
                        <option value="2083">2083</option>
                        <option value="2087">2087</option>
                        <option value="2096">2096</option>
                        <option value="8443">8443</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="optimizeConcurrency">Test Thread Count:</label>
                    <input type="number" id="optimizeConcurrency" min="1" max="32" value="8" class="optimize-concurrency-input" placeholder="1-32" oninput="validateConcurrency(this)" onchange="validateConcurrency(this)">
                </div>
            </div>

            <!-- Progress bar -->
            <div class="optimize-progress-bar hidden-section" id="optimizeProgressBar">
                <div class="optimize-progress-fill" id="optimizeProgressFill"></div>
                <div class="optimize-progress-text" id="optimizeProgressText">0/512 (0.00%) - Success: 0, Failed: 0</div>
            </div>

            <!-- Results tabs -->
            <div id="optimizeResultsTabs" class="optimize-results-tabs hidden-section"></div>

            <!-- Results content -->
            <div id="optimizeResultsContent" class="optimize-results-content hidden-section"></div>

            <!-- Button group -->
            <div class="optimize-buttons">
                <span class="save-tip"> Save Tip: Only save the top 16 optimized IPs with lowest latency</span>
                <button type="button" class="btn btn-start-optimize" id="btnStartOptimize" onclick="startOptimize()">Start Optimization</button>
                <button type="button" class="btn btn-save-override" id="btnSaveOverride" onclick="saveOptimizeResults('override')" disabled>Override Save</button>
                <button type="button" class="btn btn-save-append" id="btnSaveAppend" onclick="saveOptimizeResults('append')" disabled>Append Save</button>
                <button type="button" class="btn btn-secondary" onclick="closeOnlineOptimizeModal()">Close</button>
            </div>
        </div>
    </div>

    <!-- API Optimization Modal -->
    <div class="modal-overlay" id="apiOptimizeModal" onclick="closeAPIOptimizeModal(event)">
        <div class="modal api-optimize-modal" onclick="event.stopPropagation()">
            <button type="button" class="modal-close" onclick="closeAPIOptimizeModal()"></button>
            <h2 class="api-optimize-modal-title"> Optimization API</h2>

            <!-- API URL input -->
            <div class="api-form-group">
                <div class="api-form-row">
                    <label>API URL:</label>
                    <input type="text" id="apiOptimizeURL" placeholder="Enter API interface URL" title="API Interface URL" oninput="autoConvertGitHubURL(); autoDetectPortFromURL()">
                </div>
            </div>

            <!-- Default port input -->
            <div class="api-form-group">
                <div class="api-form-row">
                    <label>Default Port:</label>
                    <input type="number" id="apiOptimizePort" value="443" min="1" max="65535" placeholder="1-65535" title="Default Port (1-65535)">
                </div>
            </div>

            <!-- Results display area -->
            <div class="api-results-container">
                <label class="api-results-label">Interface Results:</label>
                <textarea id="apiOptimizeResults" class="api-results-textarea" readonly placeholder="Interface return results will be displayed here, one address per line"></textarea>
            </div>

            <!-- Button group -->
            <div class="api-buttons">
                <button type="button" class="btn btn-verify-api" id="btnVerifyAPI" onclick="verifyAPIOptimize()">Availability Check</button>
                <button type="button" class="btn btn-append-api" id="btnAppendAPI" onclick="appendAPIToCustom()" disabled>Append API</button>
                <button type="button" class="btn btn-append-results" id="btnAppendResults" onclick="appendResultsToCustom()" disabled>Append Results</button>
                <button type="button" class="btn btn-close-api" onclick="closeAPIOptimizeModal()">Close</button>
            </div>
        </div>
    </div>

    <!-- ProxyIP Help Popup -->
    <div class="modal-overlay" id="proxyIPHelpModal" onclick="closeProxyIPHelpModal(event)">
        <div class="modal proxyip-help-modal" onclick="event.stopPropagation()">
            <button type="button" class="modal-close" onclick="closeProxyIPHelpModal()"></button>

            <!-- Simple mode -->
            <div id="proxyIPHelpSimple" style="display: none;">
                <div class="api-docs">
                    <h2 class="section-title"> Why do we need reverse proxy mode? What is PROXYIP?</h2>

                    <div class="simple-explanation">
                        <strong>Explained in the simplest terms:</strong><br><br>
                        
                        <strong> The problem is this:</strong><br>
                        Our edgetunnel service is deployed on Cloudflare Workers. But Cloudflare has a limitation - their Workers cannot directly access Cloudflare's own services.<br><b>It's like a person named Cloudflare can never see themselves from their own eyes.</b><br><br>
                        
                        <strong> The solution:</strong><br>
                        To solve this problem, we need to use external servers (ProxyIP, SOCKS5, or HTTP) as "jump points" to proxy access to Cloudflare services through these third-party servers.<br><b>It's like finding a mirror (ProxyIP/SOCKS5/HTTP) so Cloudflare can see itself through the mirror.</b><br><br>
                        
                        <strong> Actual effect:</strong>
                        <ul style="margin: 12px 0 0 20px; padding-left: 0;">
                            <li style="margin-bottom: 8px;"> When accessing <strong>non-Cloudflare CDN websites</strong> (like <b>YouTube, Google</b>, etc.), your IP is determined by "Optimized IP"</li>
                            <li> When accessing <strong>websites hosted by Cloudflare CDN</strong> (like <b>Twitter, ChatGPT</b>, etc.), your IP is determined by "Reverse Proxy Mode (PROXYIP/SOCKS5/HTTP)"</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Detailed mode -->
            <div id="proxyIPHelpDetail" style="display: block;">
                <div class="api-docs">
                    <h2 class="section-title"> Why do we need reverse proxy mode? What is PROXYIP?</h2>
                    <h3 style="color: var(--text-primary); margin: 24px 0 16px;"> Why do we need reverse proxy mode?</h3>
                    <p style="margin-bottom: 16px; line-height: 1.8; color: var(--text-secondary);">
                        According to Cloudflare Workers' <a
                            href="https://developers.cloudflare.com/workers/runtime-apis/tcp-sockets/" target="_blank"
                            rel="noopener" style="color: var(--primary-color); text-decoration: none;">TCP Sockets
                            official documentation</a>, there are the following technical limitations:
                    </p>
                    <div class="code-block">
                         Outbound TCP sockets to <a href="https://www.cloudflare.com/ips/" target="_blank"
                            rel="noopener" style="color: inherit; text-decoration: underline;">Cloudflare IP ranges
                            </a> are temporarily blocked, but will be re-enabled shortly.
                    </div>

                    <p style="margin: 16px 0; line-height: 1.8; color: var(--text-secondary);">
                        This means Cloudflare Workers cannot directly connect to Cloudflare's own IP address ranges. To solve this limitation, we need to use third-party cloud service provider servers as "jump points":
                    </p>

                    <p style="margin-bottom: 16px; line-height: 1.8; color: var(--text-secondary);">
                        Our <b>edgetunnel</b> is deployed on Cloudflare Workers. According to Cloudflare Workers' restriction policy, Workers nodes cannot directly connect to Cloudflare's own IP address ranges. This means:
                    </p>
                    <ul style="margin: 12px 0 16px; padding-left: 20px; line-height: 1.8;">
                        <li style="margin-bottom: 8px; color: var(--text-secondary);"> Can normally access non-Cloudflare CDN sites</li>
                        <li style="color: var(--text-secondary);"> Cannot directly access websites hosted by Cloudflare CDN</li>
                    </ul>
                    <p style="margin-bottom: 16px; line-height: 1.8; color: var(--text-secondary);">
                        Therefore, reverse proxy mode is needed to solve this problem. Reverse proxy mode uses third-party servers as "intermediaries" to help Workers bypass this restriction.
                    </p>

                    <div
                        style="background: var(--bg-secondary); padding: 20px; border-radius: var(--border-radius-sm); margin: 20px 0;">
                        <div
                            style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px; flex-wrap: wrap; gap: 16px;">
                            <div
                                style="background: #e3f2fd; padding: 12px; border-radius: 8px; text-align: center; flex: 1; min-width: 120px;">
                                <div style="font-weight: 600; color: #1976d2;">Cloudflare Workers</div>
                                <div style="font-size: 0.9rem; color: var(--text-secondary);">Initiate Request</div>
                            </div>
                            <div style="color: var(--primary-color); font-size: 1.5rem;"></div>
                            <div
                                style="background: #f3e5f5; padding: 12px; border-radius: 8px; text-align: center; flex: 1; min-width: 120px;">
                                <div style="font-weight: 600; color: #7b1fa2;">PROXYIP/SOCKS5/HTTP Server</div>
                                <div style="font-size: 0.9rem; color: var(--text-secondary);">Third-party Proxy</div>
                            </div>
                            <div style="color: var(--primary-color); font-size: 1.5rem;"></div>
                            <div
                                style="background: #e8f5e8; padding: 12px; border-radius: 8px; text-align: center; flex: 1; min-width: 120px;">
                                <div style="font-weight: 600; color: #388e3c;">Cloudflare Service</div>
                                <div style="font-size: 0.9rem; color: var(--text-secondary);">Target Service</div>
                            </div>
                        </div>
                        <p style="text-align: center; color: var(--text-secondary); font-size: 0.95rem; margin: 0;">
                            Reverse proxy Cloudflare's 443 port through third-party servers to enable Workers access to Cloudflare services
                        </p>
                    </div>

                    <h3 style="color: var(--text-primary); margin: 24px 0 16px;"> Practical Application Effect</h3>
                    <p style="margin-bottom: 16px; line-height: 1.8; color: var(--text-secondary);">
                        Therefore, your IP location when accessing the network depends on the type of target website you're accessing:
                    </p>
                    <ul style="margin: 12px 0; padding-left: 20px; line-height: 1.8;">
                        <li style="margin-bottom: 12px; color: var(--text-secondary);"> When accessing <strong>non-Cloudflare CDN
                                sites</strong> (like <b>YouTube, Google</b>, etc.), your IP location is determined by "Optimized IP"</li>
                        <li style="color: var(--text-secondary);"> When accessing <strong>websites hosted by Cloudflare CDN</strong> (like <b>Twitter, ChatGPT</b>, etc.), your IP
                            location is determined by "ProxyIP/SOCKS5/HTTP"</li>
                    </ul>
                </div>
            </div>

            <!-- Toggle button -->
            <div class="toggle-switch">
                <input type="checkbox" id="proxyIPSimpleMode" onchange="toggleProxyIPHelpMode()">
                <label for="proxyIPSimpleMode">I'm a beginner, I don't understand</label>
            </div>

            <button type="button" class="btn btn-primary btn-close-modal" onclick="closeProxyIPHelpModal()"
                style="margin-top: 20px;">Close</button>
        </div>
    </div>

    <script data-cfasync="false">
        // Initialize theme
        function initializeTheme() {
            const saved = localStorage.getItem('theme');
            let theme = saved;

            // If first time opening, decide based on system theme
            if (!saved) {
                theme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
            }

            applyTheme(theme);
        }

        // Apply theme
        function applyTheme(theme) {
            if (theme === 'dark') {
                document.documentElement.classList.add('dark-mode');
                localStorage.setItem('theme', 'dark');
            } else {
                document.documentElement.classList.remove('dark-mode');
                localStorage.setItem('theme', 'light');
            }
        }

        // Toggle theme
        function toggleTheme() {
            const isDark = document.documentElement.classList.contains('dark-mode');
            applyTheme(isDark ? 'light' : 'dark');
        }

        // Show toast notification
        function showToast(message, type = 'info') {
            // Remove existing toast
            const existingToast = document.querySelector('.toast');
            if (existingToast) {
                existingToast.remove();
            }

            // Create new toast
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            toast.textContent = message;
            document.body.appendChild(toast);

            // Show animation
            setTimeout(() => toast.classList.add('show'), 10);

            // Auto hide
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // Toggle module
        function toggleModule(titleEl) {
            const module = titleEl.parentElement;
            const content = module.querySelector('.module-content');

            // If there's no collapsible content, just toggle the class
            if (!content) {
                module.classList.toggle('collapsed');
                return;
            }

            const isCollapsed = module.classList.contains('collapsed');

            if (isCollapsed) {
                // Expand
                content.style.display = 'block';
                module.classList.remove('collapsed');
            } else {
                // Collapse
                content.style.display = 'none';
                module.classList.add('collapsed');
            }
        }

        // Copy subscription
        function copySubscription(elementId) {
            const element = document.getElementById(elementId);
            navigator.clipboard.writeText(element.value).then(() => {
                showToast('Copied to clipboard', 'success');
            }).catch(() => {
                showToast('Copy failed', 'error');
            });
        }

        // Show QR code
        function showQRCode(elementId) {
            const text = document.getElementById(elementId).value;
            const container = document.getElementById('qrcodeContainer');
            container.innerHTML = '';
            new QRCode(container, {
                text: text,
                width: 300,
                height: 300,
                colorDark: '#000',
                colorLight: '#fff',
                correctLevel: QRCode.CorrectLevel.H
            });
            document.getElementById('qrcodeModal').classList.add('show');
        }

        // Close QR code
        function closeQRCode(event) {
            if (!event || event.target.id === 'qrcodeModal') {
                document.getElementById('qrcodeModal').classList.remove('show');
            }
        }

        // Reset configuration with confirmation
        function resetConfigWithConfirm() {
            document.getElementById('resetModal').classList.add('show');
        }

        // Close reset modal
        function closeResetModal(event) {
            if (!event || event.target.id === 'resetModal') {
                document.getElementById('resetModal').classList.remove('show');
            }
        }

        // Confirm reset
        function confirmReset() {
            showToast('Configuration has been reset to default values', 'success');
            closeResetModal();
        }

        // Logout
        function logout() {
            showToast('Logged out successfully', 'success');
            // In a real application, this would redirect to logout endpoint
        }

        // Initialize
        initializeTheme();
        window.addEventListener('DOMContentLoaded', function() {
            // Set page title
            document.getElementById('pageTitle').textContent = 'edgetunnel Settings Page - Management Dashboard';
            document.title = 'edgetunnel Settings Page - Management Dashboard';
        });

        // Update countdown
        function updateCountdown() {
            const now = new Date();
            const nextMidnightUTC = new Date(now);
            nextMidnightUTC.setUTCHours(0, 0, 0, 0);
            nextMidnightUTC.setUTCDate(nextMidnightUTC.getUTCDate() + 1); // Always set to tomorrow's 0:00

            const diff = nextMidnightUTC - now;
            const hours = Math.floor(diff / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((diff % (1000 * 60)) / 1000);

            document.getElementById('countdown').innerHTML = `<span class="countdown-text">Resets in</span> <span class="countdown-numbers">${hours.toString().padStart(2, '0')}</span><span class="countdown-text"> hours</span><span class="countdown-numbers">${minutes.toString().padStart(2, '0')}</span><span class="countdown-text"> minutes</span><span class="countdown-numbers">${seconds.toString().padStart(2, '0')}</span><span class="countdown-text"> seconds</span>`;
        }

        // Start countdown update
        setInterval(updateCountdown, 1000);
        updateCountdown(); // Execute immediately once

        // Set status indicator
        function setStatus(id, status) {
            const indicator = document.getElementById(id);
            if (indicator) {
                indicator.className = 'status-indicator status-' + status;
            }
        }

        // Load network information
        async function loadNetworkInfo() {
            // Check if container exists
            const container = document.querySelector('.network-cards-container');
            if (!container) return;

            // Set loading status for all indicators
            setStatus('status-ipip', 'loading');
            setStatus('status-edgeone', 'loading');
            setStatus('status-cf', 'loading');
            setStatus('status-twitter', 'loading');

            // Simulate network data loading (in a real application, this would fetch from APIs)
            setTimeout(() => {
                document.getElementById('ipip-ip').textContent = '192.168.1.1';
                document.getElementById('ipip-country').textContent = 'United States';
                setStatus('status-ipip', 'success');

                document.getElementById('edgeone-ip').textContent = '203.0.113.1';
                document.getElementById('edgeone-country').textContent = 'United States AS12345 Example ISP';
                setStatus('status-edgeone', 'success');

                document.getElementById('cf-ip').textContent = '104.16.248.1';
                document.getElementById('cf-country').textContent = 'United States Cloudflare';
                setStatus('status-cf', 'success');

                document.getElementById('twitter-ip').textContent = '199.59.148.1';
                document.getElementById('twitter-country').textContent = 'United States Twitter';
                setStatus('status-twitter', 'success');
            }, 1000);
        }

        // Page load event
        if (document.readyState !== 'loading') {
            // Page already loaded, load data directly
            loadNetworkInfo();
        } else {
            // Page still loading, wait for load completion
            document.addEventListener('DOMContentLoaded', () => {
                loadNetworkInfo();
            });
        }
    </script>
</body>
</html>
